<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>11.1.3 Setup</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1439-00-11-00-00.html">Chapter&nbsp;11 High-Speed Data Load</a> &gt; <a href="b1439-00-11-01-00.html">11.1 Installing High-Speed Data Load</a> &gt; 11.1.3 Setup</div><div class="back_next"><a href="b1439-00-11-01-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-11-02-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="load_0103">11.1.3 Setup</h3><div class="body"><div class="textblock"><p>This section describes how to set up high-speed data load.</p><p></p></div><p class="subhead_1" id="ID0600-loadN3"><span class="em">Setup flow</span></p><div class="textblock"><ol><li><p><a href="b1439-00-11-01-03.html#load_010301"><span class="u">Setting Parameters</span></a></p></li><li><p><a href="b1439-00-11-01-03.html#load_010302"><span class="u">Installing the Extension</span></a></p></li></ol></div></div><h4 id="load_010301">11.1.3.1 Setting Parameters</h4><div class="body"><div class="textblock"><p>Set the parameters required for high-speed data load in postgresql.conf. After that, start or restart the instance.</p><p>The table below lists the postgresql.conf parameters that must be changed, and the values that must be added to their current values. After editing postgresql.conf, start or restart the instance.</p><table><col><col><col><tr><th valign="middle"><p>Parameter</p></th><th valign="middle"><p>Setting</p></th><th valign="middle"><p>Required</p></th></tr><tr><td align="left" valign="top"><p>max_prepared_transactions</p></td><td align="left" valign="top"><p>Add the number of transactions that can be prepared by parallel workers during data load to the parameter's current value.</p><p>The resulting value must be equal to or greater than the maximum number of parallel workers used with this feature.</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>max_worker_processes</p></td><td align="left" valign="top"><p>Number of parallel workers to perform data load. </p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>max_parallel_workers</p></td><td align="left" valign="top"><p>Add the maximum number of parallel workers to be used in a parallel query by this feature to the parameter's current value.</p><p>The resulting value must be equal to or greater than the number of parallel workers used with this feature.</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr></table><div class="ex"><p class="title">Example</p><div class="exbody"><p>The example below shows how to configure 2 instances of high-speed data load being executed simultaneously using a degree of parallelism of 4.</p><pre class="border">max_prepared_transactions = 13  #Example if the initial value was 5: 5 + 2 x 4 = 13max_worker_processes = 16        #Example if the initial value was 8: 8 + 2 x 4 = 16max_parallel_workers = 12        #Example if the initial value was 4: 4 + 2 x 4 = 12</pre></div></div><div class="note"><p class="title">Note</p><div class="notebody"><p>As shown in the example above, set the value of max_prepared_transactions, max_worker_processes and max_parallel_workers multiplied by the number of instances of this feature executed simultaneously.</p></div></div><p>The table below lists the postgresql.conf parameters that must also be checked.</p><table><col><col><col><tr><th valign="middle"><p>Parameter</p></th><th valign="middle"><p>Setting</p></th><th valign="middle"><p>Required</p></th></tr><tr><td align="left" valign="top"><p>dynamic_shared_memory_type</p></td><td align="left" valign="top"><p>Implementation of dynamic shared memory to be used by the instance.</p><p>The default value is recommended.</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr></table><div class="ref"><p class="title">See</p><div class="refbody"><p>Refer to "Resource Consumption" in the PostgreSQL Documentation for information on the parameters.</p></div></div></div></div><h4 id="load_010302">11.1.3.2 Installing the Extension</h4><div class="body"><div class="textblock"><p>Execute CREATE EXTENSION to install the high-speed data load extension. The extension needs to be installed on each database.</p><div class="ex"><p class="title">Example</p><div class="exbody"><p>The example below installs the extension on the "postgres" database.</p><pre class="border">postgres=# CREATE EXTENSION pgx_loader;CREATE EXTENSION</pre></div></div><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Only superusers can install the high-speed data load extension.</p></li><li><p>The high-speed data load extension can only be installed on the public schema.</p></li></ul></div></div></div></div><div class="header_footer"><div class="back_next"><a href="b1439-00-11-01-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-11-02-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>