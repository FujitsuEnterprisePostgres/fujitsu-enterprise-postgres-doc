<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>Chapter&nbsp;3 Backing Up the Database</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist">Chapter&nbsp;3 Backing Up the Database</div><div class="back_next"><a href="b1439-00-02-02-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-03-01-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h1 id="br030000">Chapter&nbsp;3 Backing Up the Database</h1><div class="body"><div class="textblock"><p>This chapter describes how to back up the database.</p><dl><dt class="em">Backup methods</dt><dd><p>The following backup methods enable you to recover data to a backup point or to the state immediately preceding disk physical breakdown or data logical failure.</p><ul><li><p>Backup using WebAdmin</p><p>This method enables you to back up data through intuitive window operations using the GUI.</p><p>WebAdmin is used for recovery.</p></li><li><p>Backup using the pgx_dmpall command</p><p>Execute the pgx_dmpall command with a script to perform automatic backup.</p><p>To back up data automatically, you must register the process in the automation software of the operating system. Follow the procedure given in the documentation for your operating system.</p><p>The pgx_rcvall command is used for recovery.</p></li></ul><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>By using a copy command created by the user, the pgx_dmpall command and the pgx_rcvall command can back up database clusters and tablespaces to any destination and recover them from any destination using any copy method. Refer to "<a href="b1439-00-14-00-00.html">Chapter&nbsp;14 Backup/Recovery Using the Copy Command</a>" for details.</p></div></div></dd></dl><dl><dt class="em">Approximate backup time<a name="N18G"></a></dt><dd><p>The formula for deriving the approximate backup time when you use WebAdmin or the pgx_dmpall command is as follows:</p><pre class="border"><span class="i">backupTime</span> = <span class="i">dataStorageDestinationUsage</span> / <span class="i">diskWritePerformance</span> x 1.5</pre><ul><li><p><span class="i">dataStorageDestinationUsage</span>: Disk usage at the data storage destination</p></li><li><p><span class="i">diskWritePerformance</span>: Maximum data volume (bytes/second) that can be written per second in the system environment where operation is performed</p></li><li><p>1.5: Coefficient to factor in tasks other than disk write (which is the most time-consuming step)</p></li></ul><p>If using the copy command with the pgx_dmpall command, the backup time will depend on the implementation of the copy command.</p></dd></dl><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Backup operation cannot be performed on an instance that is part of a streaming replication cluster in standby mode.</p></li><li><p>Use the selected backup method continuously.</p><p>There are several differences, such as the data format, across the backup methods. For this reason, the following restrictions apply:</p><ul><li><p>It is not possible to use one method for backup and another for recovery.</p></li><li><p>It is not possible to convert one type of backup data to a different type of backup data.</p></li></ul></li><li><p>Mirrored WALs can be used only for backup/recovery using the pgx_dmpall command or WebAdmin.</p></li><li><p>There are several considerations for the backup of the keystore and backup of the database in case the data stored in the database is encrypted. Refer to the following for details:</p><ul><li><p><a href="b1439-00-05-06-04.html">5.6.4 Backing Up and Recovering the Keystore</a></p></li><li><p><a href="b1439-00-05-07-00.html">5.7 Backing Up and Restoring/Recovering the Database</a></p></li></ul></li></ul><ul><li><p>If you have defined a tablespace, back it up. If you do not back it up, directories for the tablespace are not created during recovery, which may cause the recovery to fail. If the recovery fails, refer to the event log, create the tablespace, and then perform the recovery process again.</p></li><li><p>If performing backups with WebAdmin, the following password file is temporarily created during backup for WebAdmin to connect to the database:</p><ul><li><p><span class="i">userProfileFolder</span>\<span class="i">localSettingsFolder</span>\Fujitsu\fsep_<span class="i">version</span>\<span class="i">instanceName</span>\pgpass.conf</p></li></ul><p>Therefore, when you are backing up corefiles created in the core_directory parameter of postgresql.conf, or log files created in the log_directory parameter of postgresql.conf, ensure not to back up the password files located in the same directories at the same time.</p></li></ul></div></div><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>The following methods can also be used to perform backup. Performing a backup using these methods allows you to restore to the point when the backup was performed.</p><ul><li><p>Backup using an SQL-based dump</p><p>Dump the data by using SQL. This backup method also enables data migration.</p></li><li><p>File system level backup</p><p>This backup method requires you to stop the instance and use OS commands to backup database resources as files.</p></li><li><p>Backup by continuous archiving</p><p>This is the standard backup method for PostgreSQL.</p></li></ul><p>Refer to "Backup and Restore" in "Server Administration" in the PostgreSQL Documentation for information on these backup methods.</p></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="b1439-00-02-02-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-03-01-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>