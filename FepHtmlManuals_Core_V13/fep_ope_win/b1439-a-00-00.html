<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>Appendix&nbsp;A Parameters</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist">Appendix&nbsp;A Parameters</div><div class="back_next"><a href="b1439-00-15-15-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-b-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h1 id="br0A0000" class="app">Appendix&nbsp;A Parameters</h1><div class="body"><div class="textblock"><p>This appendix describes the parameters to be set in the postgresql.conf file of FUJITSU Enterprise Postgres.</p><p>The postgresql.conf file is located in the data storage destination.</p><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>The maximum value that can be expressed as a 4-byte signed integer changes according to the operating system. Follow the definition of the operating system in use.</p></div></div><div class="note"><p class="title">Note</p><div class="notebody"><p>Note the following when specifying the path:</p><ul><li><p>Specify \\ as the path delimiter.</p></li><li><p>Enclose the path in double quotes (") if it contains spaces.</p></li></ul></div></div><ul><li><p>core_directory (string)<a name="N98G"></a></p><p>This parameter specifies the directory where the corefile is to be output. If this parameter is omitted, the data storage destination is used by default. This parameter can only be set when specified on starting an instance. It cannot be changed dynamically, while an instance is active.<br></p></li><li><p>core_contents (string)<a name="N99G"></a></p><p>This parameter specifies the contents to be included in the corefile.</p><ul><li><p>full: Outputs all contents of the server process memory to the corefile.</p></li><li><p>none: Does not output a corefile.</p></li><li><p>minimum: Outputs only non-shared memory server processes to the corefile. This reduces the size of the corefile. However, in some cases, this file may not contain sufficient information for examining the factor that caused the corefile to be output.</p></li></ul><p>If this parameter is omitted, "minimum" is used by default. This parameter can only be set when specified on starting an instance. It cannot be changed dynamically, while an instance is active.</p></li><li><p>keystore_location (string)<a name="N100G"></a></p><p>This parameter specifies the directory that stores the keystore file. Specify a different location from other database clusters. This parameter can only be set when specified on starting an instance. It cannot be changed dynamically, while an instance is active.</p></li><li><p>tablespace_encryption_algorithm (string)<a name="N105G"></a></p><p>This parameter specifies the encryption algorithm for tablespaces that will be created. Valid values are "AES128", "AES256", and "none". If you specify "none", encryption is not performed. The default value is "none". To perform encryption, it is recommended that you specify "AES256". Only superusers can change this setting.</p></li><li><p>backup_destination (string)<a name="N106G"></a></p><p>This parameter specifies the absolute path of the directory where pgx_dmpall will store the backup data. Specify a different location from other database clusters. This parameter can only be set when specified on starting an instance. It cannot be changed dynamically, while an instance is active.</p><p>Place this directory on a different disk from the data directory to be backed up and the tablespace directory. Ensure that users do not store arbitrary files in this directory, because the contents of this directory are managed by the database system.</p></li><li><p>search_path (string)<a name="N107G"></a></p><p>When using the SUBSTR function compatible with Oracle databases, set "oracle" and "pg_catalog" in the search_path parameter. You must specify "oracle" before "pg_catalog".</p><div class="ex"><p class="title">Example</p><div class="exbody"><pre class="border">search_path = '"$user", public, oracle, pg_catalog'</pre></div></div><div class="tips"><p class="title">Information</p><div class="tipsbody"><ul><li><p>The search_path feature specifies the priority of the schema search path. The SUBSTR function in Oracle database is defined in the oracle schema.</p></li><li><p>Refer to "Statement Behavior" under "Server Administration" in the PostgreSQL Documentation for information on search_path.</p></li></ul></div></div></li><li><p>track_waits (string)<a name="N108G"></a></p><p>This parameter enables collection of statistics for pgx_stat_lwlock and pgx_stat_latch.</p><ul><li><p>on: Enables collection of statistics.</p></li><li><p>off: Disables collection of statistics.</p></li></ul><p>If this parameter is omitted, "on" is assumed.</p><p>Only superusers can change this setting.</p></li><li><p>track_sql (string)<a name="N109G"></a></p><p>This parameter enables collection of statistics for pgx_stat_sql.</p><ul><li><p>on: Enables collection of statistics.</p></li><li><p>off: Disables collection of statistics.</p></li></ul><p>If this parameter is omitted, "on" is assumed.</p><p>Only superusers can change this setting.</p></li></ul><br><dl><dt class="em">Parameters for the in-memory feature</dt><dd></dd></dl><ul><li><p>reserve_buffer_ratio (numerical value)<a name="N111G"></a></p><p>This parameter specifies the proportion of shared memory to be used for a stable buffer table.</p><ul><li><p>Minimum value: 0</p></li><li><p>Maximum value: 80</p></li></ul><p>If this parameter is omitted, 0 will be used.</p></li><li><p>vci.cost_threshold (numerical value)<a name="N112G"></a></p><p>This parameter specifies the lowest cost that selects an execution plan that uses a VCI. If the cost of the best execution plan that does not use a VCI is lower than this value, that execution plan will be selected.</p><ul><li><p>Minimum value: 0</p></li><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 18000 will be used.</p></li><li><p>vci.control_max_workers (numerical value)<a name="N113G"></a></p><p>This parameter specifies the number of background workers that manage VCI. The number of workers for the entire instance is limited by max_worker_processes, so add the value specified here to max_worker_processes.</p><ul><li><p>Minimum value: 1</p></li><li><p>Maximum value: 8388607</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 8 will be used.</p></li><li><p>vci.enable (string)<a name="N114G"></a></p><p>This parameter enables or disables VCI.</p><ul><li><p>on: Enables VCI.</p></li><li><p>off: Disables VCI.</p></li></ul><p>If this parameter is omitted, "on" will be used.</p></li><li><p>vci.log_query (string)<a name="N115G"></a></p><p>This parameter enables or disables log output when VCI is not used due to insufficient memory specified by vci.max_local_ros.</p><ul><li><p>on: Enables log output.</p></li><li><p>off: Disables log output.</p></li></ul><p>If this parameter is omitted, "off" will be used.</p></li><li><p>vci.maintenance_work_mem (numerical value)<a name="N116G"></a></p><p>This parameter specifies the maximum memory size used for maintenance of VCI (when executing CREATE INDEX, for example).</p><ul><li><p>Minimum value: 1 MB</p></li></ul><ul><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer / 1024</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 256 MB will be used.</p></li><li><p>vci.max_local_ros (numerical value)<a name="N117G"></a></p><p>This parameter specifies the maximum memory size used for VCI scan.</p><ul><li><p>Minimum value: 64 MB</p></li><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 64 MB will be used.</p></li><li><p>vci.max_parallel_degree (numerical value)<a name="N118G"></a></p><p>This parameter specifies the maximum number of background workers used for parallel scan. The number of workers for the entire instance is limited by max_worker_processes, so add the value specified here to max_worker_processes.</p><p>A value from -8388607 to 8388607 can be specified.</p><ul><li><p>Integer (1 or greater): Parallel scan is performed using the specified degree of parallelism.</p></li><li><p>0: Stops the parallel scan process.</p></li><li><p>Negative number: The specified value minus the maximum number of CPUs obtained from the environment is used as the degree of parallelism and parallel scan is performed.</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 0 will be used.</p></li><li><p>vci.shared_work_mem (numerical value)<a name="N119G"></a></p><p>This parameter specifies the maximum memory size used for VCI parallel scan.</p><ul><li><p>Minimum value: 32 MB</p></li><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer</p></li></ul><p>If this parameter is omitted or a value outside this range is specified, 1 GB will be used.</p></li></ul><ul><li><p>vci.smc_directory (string)</p><p>This parameter specifies a directory name in which a temporary file is created as the dynamic shared memory during a scan using a VCI.</p><p>If this parameter is omitted, a directory (<span class="i">dataStorageDir</span>\\base\\pgsql_tmp) under the data storage directory will be used.</p></li></ul><br><dl><dt class="em">Parameters for the Global Meta Cache feature</dt><dd></dd></dl><ul><li><p>pgx_global_metacache (numerical value)<a name="N120G"></a></p><p>Specifies the memory size of the GMC area.</p><p>Specify a value calculated by the formula below.</p><p>A value lower than the calculated value will still work, but the meta cache may not be able to fit into the GMC area.</p><p>In this case, the system will discard the meta cache it thinks it is no longer needed, but if it is needed again, the meta cache will need to be expanded and will not perform well.</p><p>If the value is less than 10 MB and is set to a nonzero value that disables the feature, the database startup fails because the Global Meta Cache feature cannot operate.</p><p>A setting of 0 disables the Global Meta Cache feature. The default is 0.</p><p>Changing this setting requires restarting the database.</p><pre>Size of GMC area = Max(10MB,      (All user table x 0.4 KB      + All user Indexes x 0.3 KB      + All user columns x 0.8 KB) x 1.5 <span class="inline-note">*1</span> )*1) Safety Factor (1.5)This value takes into account the case where both GMC before and after the change temporarily exist at the same time in shared memory when the table definition is changed or the row of the system catalog is changed.</pre></li><li><p>track_gmc (string)<a name="N121G"></a></p><p>This parameter enables collection of statistics for pgx_stat_gmc.</p><ul><li><p>on: Enables collection of statistics.</p></li><li><p>off: Disables collection of statistics.</p></li></ul><p>If this parameter is omitted, "on" is used.</p><p>Only superusers can change this setting.</p><br></li></ul><dl><dt class="em" id="br0A0000_lm">Parameters for the Local Meta Cache Limit feature</dt><dd></dd></dl><ul><li><p>pgx_catalog_cache_max_size(numerical value)</p><p>Specifies the maximum amount of memory that the backend process should use as the catalog cache.</p><p>You can enable catalog cache deletion by setting it to 8 KB or more.</p><p>A setting of 0 disables the catalog cache removal. The default is 0.</p><p>If no units are specified, they are treated as KB.</p><ul><li><p>Minimum value: 8KB</p></li><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer</p></li></ul><p>When calculating the parameter settings, the factors that determine the cache size are calculated as the number of tables, the number of indexes, and the number of columns. What is kept as a catalog cache or relation cache also includes objects such as databases, roles, or procedures, but these are small compared to the above factors and do not need to be factored into them. It also includes a calculation method for pgx_relacion_cache_max_size because the given memory is distributed between the catalog cache and the relation cache.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>The calculation method here assumes that all backends have similar access and that the transaction also has access to a similar number of resources. If you have a small number of singular backends or transactions, consider excluding them as errors.</p></div></div><ol><li><p>Determine how much memory a backend process can use. Decide by subtracting the memory size required by the entire system such as the database cache from the installed memory and dividing the rest by the number of connections.</p></li><li><p>For best performance, use the following formula to calculate the total memory size of the catalog cache when the backend holds the catalog cache for all resources accessed during its lifetime.<br>The amount of memory varies depending on whether Global Meta Cache is enabled or disabled. Enabling Global Meta Cache reduces the amount of memory required because most of the cache is located on shared memory.</p><pre>When Global Meta Cache is enabled:  (Number of tables to access + Number of indexes to access + Number of columns to access)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&times; 0.1KB &times; 1.5 <span class="inline-note">*1</span>When Global Meta Cache is disabled:&nbsp;&nbsp;{ Number of tables to access &times; 0.5KB(pg_class tuple size)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ Number of indexes to access &times; 0.5KB(pg_index tuple size)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ Number of columns to access &times; 1.0KB(pg_statistic tuple size)} &times; 1.5 <span class="inline-note">*1</span>*1) Safety Factor (1.5)The system catalog contains columns with variable-length types. For example, the tuple size in pg_class is a constant value multiplied by the number of tables, while relname in pg_class is variable length data.It is not practical to calculate every definition in detail, so we added 50% to the above formula.</pre></li><li><p>In the same way as in 2., calculate the relation cache using the following formula.</p><pre>  (1.4KB &times; Number of tables to access + 2.4KB &times; Number of indexes to access) &times; 1.5 <span class="inline-note">*1</span>*1) Safety Factor (1.5)The relation cache is structured to facilitate the use of table and index definitions, holds pointers to various objects, and is sized to include them. It is variable length because the type of object allocated by the table definition and its size change. Since it is not realistic to calculate for all definitions, 50% is added.</pre></li><li><p>If the value of 1. &ge; the value of 2. + the value of 3., the backend process can keep all caches to the extent allowed, so there is no need to limit the caches. If you want to cap for safety, set the value of 2. to pgx_catalog_cache_max_size and the value of 3. to pgx_relation_cache_max_size.</p></li><li><p>If the value of 1. &lt; the value of 2. + the value of 3. then you need to limit the cache. However, this parameter does not limit the size of the cache used by a transaction. Therefore, take the following steps.</p></li><li><p>Calculate the catalog cache used by a transaction using the formula in 2.</p></li><li><p>Calculate the relation cache used by a transaction using the formula in 3.</p></li><li><p>If the value of 1. &lt; the value of 6. + the value of 7., then the value of 1. needs to be increased. In other words, in some cases, it may be necessary to increase the installed memory or reduce the number of connections.</p></li><li><p>If the value of 1. &ge; the value of 6. + the value of 7., the condition of 1. can be satisfied by limiting the cache with this parameter. Divide the value of 1. by the ratio of 2. and 3. and set it as a parameter. Set the value distributed to 2. to pgx_catalog_cache_max_size and the value distributed to 3. to pgx_relation_cache_max_size.</p></li><li><p>The value calculated in 9. is a provisional value. If you cannot meet your target performance, first try to shift the focus of allocation to the relation cache. This is because when executing SQL, the relation cache generated based on the catalog cache is mainly referenced, so it is advantageous to leave a large amount of relation cache. If the performance is still not satisfied, adjust the parameters by referring to "<a href="b1439-00-13-01-04.html">13.1.4 Performance Impact and Parameter Tuning of the Local Meta Cache Limit Feature</a>".</p></li></ol><div class="note"><p class="title">Note</p><div class="notebody"><p>Be careful when partitioning the table.</p><p>The cached definition changes depending on whether the parent table is specified in the SQL statement or the child table is specified. In particular, note that if you specify a parent table, the definitions of all child tables are cached. This is because when you specify a parent table in an SQL statement, you need to know the definitions of all the child tables in order to determine which child table will contain the desired data. Note that the column information of the parent table is not cached.</p><p>When specifying the parent table:</p><pre>  Number of tables to access = Number of parent tables to access + Number of defined child tables  Number of columns = Number of defined columns x number of defined child tables</pre><p>When specifying the child table directly:</p><pre>  Number of tables to access = Number of child tables actually accessed  Number of columns ＝ Number of defined columns x number of child tables actually accessed </pre><p>Example)</p><p>Suppose the parent table T (1 index, 3 columns) is split from child tables T1 to T5 (1 index, 3 columns, respectively). If the parent table T is specified in SQL, when the child tables that contain the data to be queried are limited to T1 and T2, and when accessing the data using the indexes defined by T1 and T2, calculate as follows.</p><pre>  Number of tables = 1(parent table) + 5(child table) = 6  Number of indexes = 2 (index to access)  Number of columns = 3 (number of columns) x 5 (child table) = 15</pre><p>If you specify child tables T1 and T2 in SQL and use the indexes defined on T1 and T2 when accessing data, the calculation is as follows.</p><pre>  Number of tables = 2(child table)   Number of indexes = 2 (index to access)  Number of columns = 3 (number of columns) x 2 (child table) = 6</pre></div></div><br></li><li><p>pgx_relation_cache_max_size(numerical value)</p><p>Specifies the maximum amount of memory that the backend process should use as the relation cache.</p><p>You can enable catalog cache deletion by setting it to 8 KB or more.</p><p>A setting of 0 disables the relation cache removal. The default is 0.</p><p>If no units are specified, they are treated as KB.</p><ul><li><p>Minimum value: 8KB</p></li><li><p>Maximum value: Maximum value that can be expressed as a 4-byte signed integer</p></li></ul><p>For the calculation method for parameter setting, refer to the calculation method of pgx_catalog_cache_max_size.</p></li></ul><ul><li><p>pgx_cache_hit_log_interval(numerical value)</p><p>Specifies the time interval to output a message indicating the cache reference status for each backend process.</p><p>When the transaction ends, if the time set in this parameter has elapsed since the previous message was output, the message is output.</p><p>If set to 0, a message will be output each time the transaction ends.</p><p>Setting -1 disables the output. The default value is 10min.</p><p>If no units are specified, they are treated as ms.</p><p>Even if pgx_catalog_cache_max_size and pgx_relation_cache_max_size are disabled, the message output of the corresponding cache will be invalid.</p><p>Immediately after connecting to the server, a small transaction occurs before the request from the user application, such as for user authentication. Since it is meaningless to know the hit rate for these, a message will be output at the end of the transaction that started after the time set in this parameter has elapsed after connecting to the server.</p><p>For the same reason, setting a small value such as 0 may result in a message being printed at the end of such a small transaction.</p><p>You can check which transaction the message corresponds to from the information output at the beginning.</p><p>This information depends on the setting of the parameter log_line_prefix.</p><ul><li><p>Minimum value: 0</p></li><li><p>Maximum value: 2147483647ms</p></li></ul></li></ul><div class="ref"><p class="title">See</p><div class="refbody"><p>Refer to "Server Configuration" under "Server Administration" in the PostgreSQL Documentation for information on other postgresql.conf parameters.</p></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="b1439-00-15-15-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-b-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>