<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>13.1.3 Cache Removal when Local Meta Cache Limit is Enabled</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1439-00-13-00-00.html">Chapter&nbsp;13 Local Meta Cache Limit</a> &gt; <a href="b1439-00-13-01-00.html">13.1 Usage </a> &gt; 13.1.3 Cache Removal when Local Meta Cache Limit is Enabled</div><div class="back_next"><a href="b1439-00-13-01-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-13-01-04.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_lm_0103">13.1.3 Cache Removal when Local Meta Cache Limit is Enabled</h3><div class="body"><div class="textblock"><p>When this feature is enabled, the caching strategy is to keep the cache as long as possible within the specified upper limit. If holding a new cache exceeds the limit, consider locality of reference and remove the cache from the one with the longest unreferenced time.</p><p>However, because the cache used by active transactions cannot be removed, if a transaction uses a large number of caches, the cache may be held above the limit. In this case, remove the all caches at the end of the transaction. This is necessary to free up memory.</p><p>In PostgreSQL, in order to acquire memory at high speed, a memory block of a certain size is acquired from the OS, and a small memory is cut out from the block and used. The memory for the metacache is cut out in the same way. Therefore, it is possible to return the memory block to the OS by destroying all the meta caches scattered throughout the memory block. When this happens, the next SQL execution will be slowed down due to the re-creation of the meta cache. Therefore, upper limit of feature should be set to a value larger than the size of the meta cache used by at least one transaction.</p><p>When the size of the meta cache exceeds the upper limit, the following message is output:</p><pre class="border">WARNING: could not reduce Cat/RelCacheMemoryContext size to <span class="em"><span class="i"><span class="u">AA</span></span></span> kilobytes, reduced to <span class="em"><span class="i"><span class="u">BB</span></span></span> kilobytesHINT: consider increasing the configuration parameter pgx_catalog/relation_cache_max_size</pre><p>(<span class="em"><span class="i"><span class="u">AA</span></span></span>: Upper limit, <span class="em"><span class="i"><span class="u">BB</span></span></span>: Amount of memory actually used)</p><p>CatCacheMemoryContext and RelCacheMemoryContext are memory areas for storing the catalog cache and relation cache, respectively. If this message is output, consider increasing the upper limit. </p><p>If the memory consumption by the backend process exceeds the allowable value by increasing the upper limit, reconsider the SQL to be executed, such as reducing the number of tables accessed in one transaction, or add memory adjust to the amount of memory used.</p><p></p></div></div><div class="header_footer"><div class="back_next"><a href="b1439-00-13-01-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1439-00-13-01-04.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>