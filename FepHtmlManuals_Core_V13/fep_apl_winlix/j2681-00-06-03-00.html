<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>6.3 Connecting with the Database</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-00-06-00-00.html">Chapter&nbsp;6 Embedded SQL in C</a> &gt; 6.3 Connecting with the Database</div><div class="back_next"><a href="j2681-00-06-02-04.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-06-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="mID_0603">6.3 Connecting with the Database</h2><div class="body"><div class="textblock"><div class="point"><p class="title">Point</p><div class="pointbody"><ul><li><p>It is recommended to use a connection service file to specify connection destinations. In the connection service file, a name (service name) is defined as a set, comprising information such as connection destination information and various types of tuning information set for connections. By using the service name defined in the connection service file when connecting to databases, it is no longer necessary to modify applications when the connection information changes.<br>Refer to "The Connection Service File" in "Client Interfaces" in the PostgreSQL Documentation for information.</p></li><li><p>If using a connection service file, perform either of the procedures below:</p><ul><li><p>Set the service name as a string literal or host variable, as follows:</p><p>tcp:postgresql://?service=my_service</p></li><li><p>Set the service name in the environment variable PGSERVICE, and use CONNECT TO DEFAULT</p></li></ul></li></ul></div></div><p>Use the CONNECT statement shown below to create a connection to the database server.</p><p></p></div><p class="subhead_1" id="IDapl06N2"><span class="em">Format</span></p><div class="textblock"><pre class="border">EXEC SQL CONNECT TO target [AS connection-name] [USER user-name];</pre><dl><dt class="em">target</dt><dd><p>Write in one of the following formats:</p><ul><li><p>dbname@host:port</p></li><li><p>tcp:postgresql://host:port/dbname[?options]</p></li><li><p>unix:postgresql://host[:port][/dbname][?options]<br>(Definition method when using the UNIX domain socket)</p></li><li><p>SQL string literal containing one of the above formats</p></li><li><p>Reference to a character variable containing one of the above formats</p></li><li><p>DEFAULT</p></li></ul></dd></dl><dl><dt class="em">user-name</dt><dd><p>Write in one of the following formats:</p><ul><li><p>username</p></li><li><p>username/password</p></li><li><p>username IDENTIFIED BY password</p></li><li><p>username USING password</p></li></ul></dd></dl></div><p class="subhead_1" id="IDapl06N3"><span class="em">Description of the arguments</span></p><div class="textblock"><table><col><col><tr><th valign="top"><p>Argument</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>dbname</p></td><td align="left" valign="top"><p>Specify the database name.</p></td></tr><tr><td align="left" valign="top"><p>host</p></td><td align="left" valign="top"><p>Specify the host name for the connection destination.</p></td></tr><tr><td align="left" valign="top"><p>port</p></td><td align="left" valign="top"><p>Specify the port number for the database server.</p><p>The default is "27500".</p></td></tr><tr><td align="left" valign="top"><p>connection-name</p></td><td align="left" valign="top"><p>Specify connection names to identify connections when multiple connections are to be processed within a single program.</p></td></tr><tr><td align="left" valign="top"><p>username</p></td><td align="left" valign="top"><p>Specify the user that will connect with the database.</p><p>If this is omitted, the name used will be that of the user on the operating system that is executing the application.</p></td></tr><tr><td align="left" valign="top"><p>password</p></td><td align="left" valign="top"><p>Specify a password when authentication is required.</p></td></tr><tr><td bgcolor="#FFFFFF" align="left" valign="top"><p>options</p></td><td bgcolor="#FFFFFF" align="left" valign="top"><p>Specify the following parameter when specifying a time for timeout. Connect parameters with &amp; when specifying more than one. The following shows the values specified for each parameter.</p><ul><li><p>connect_timeout</p><p>Specify the timeout for connections.</p><p>Specify a value between 0 and 2147483647 (in seconds). There is no limit set if you set 0 or an invalid value. If "1" is specified, the behavior will be the same as when "2" was specified. An error occurs when a connection cannot be established within the specified time.</p></li><li><p>keepalives</p><p>This enables keepalive.</p><p>Keepalive is disabled if 0 is specified. Keepalive is enabling when any other value is specified. The default is keepalive enabled. Keepalive causes an error to occur when it is determined that the connection with the database is disabled.</p></li><li><p>keepalives_idle</p><p>Specify the time until the system starts sending keepalive messages when communication with the database is not being performed.</p><ul><li><p>Linux</p><p>Specify a value between 1 and 32767 (in seconds). The default value of the system is used if this is not specified.</p></li><li><p>Windows(R)</p><p>Specify a value between 1 and 2147483647 (in seconds). 7200 will be set as default if a value outside this range is specified or if nothing is specified.</p></li></ul></li><li><p>keepalives_interval</p><p>Specify the interval between resends when there is no response to keepalive messages.</p><ul><li><p>Linux</p><p>Specify a value between 1 and 32767 (in seconds). The default value of the system is used if this is not specified.</p></li><li><p>Windows(R)</p><p>Specify a value between 1 and 2147483647 (in seconds). 1 will be set as default if a value outside this range is specified or if nothing is specified.</p></li></ul></li><li><p>keepalives_count</p><p>Specify the number of resends for keepalive messages.</p><ul><li><p>Linux</p><p>Specify a value between 1 and 127. The default value of the system is used if this is not specified.</p></li><li><p>Windows(R)</p><p>The system default value is used irrespective of what is specified for this parameter.</p></li></ul></li><li><p>tcp_user_timeout</p><p>After establishing the connection, when sending from the client to the server, if the TCP resend process operates, specify the time until it is considered to be disconnected.</p><ul><li><p>Linux</p><p>Specify a value between 0 and 2147483647 (in millseconds). The default value of the system is used if 0. 0 will be set as default if nothing is specified.</p></li><li><p>Windows(R)</p><p>Cannot be specified.</p></li></ul></li></ul></td></tr></table><div id="lix" class="spcl_note_title"><div class="spcl_body"><div class="note"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span><p class="title">Note</p><div class="notebody"><div id="lix" class="spcl_note"><div class="spcl_body"><p>If a value other than 0 is specified for the tcp_user_timeout parameter, the waiting time set by the tcp_keepalives_idle parameter and tcp_keepalives_interval parameter will be invalid and the waiting time specified by the tcp_user_timeout parameter will be used.</p></div></div></div></div></div></div></div><p class="subhead_1" id="IDapl06N4"><span class="em">Code examples for applications</span><a name="N27G"></a><span class="em"></span></p><div class="textblock"><pre class="border">EXEC SQL CONNECT TO tcp:postgresql://sv1:27500/mydb?connect_timeout=20&amp;keepalives_idle=20&amp;keepalives_interval=5&amp;keepalives_count=2&amp;keepalives=1 USER myuser/myuser01;</pre></div></div><div class="header_footer"><div class="back_next"><a href="j2681-00-06-02-04.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-06-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>