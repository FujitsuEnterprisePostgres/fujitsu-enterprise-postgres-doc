<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>D.7.1 Setting Callbacks</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-d-00-00.html">Appendix&nbsp;D ECOBPG - Embedded SQL in COBOL</a> &gt; <a href="j2681-d-07-00.html">D.7 Error Handling</a> &gt; D.7.1 Setting Callbacks</div><div class="back_next"><a href="j2681-d-07-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-d-07-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_0e0701">D.7.1 Setting Callbacks</h3><div class="body"><div class="textblock"><p>One simple method to catch errors and warnings is to set a specific action to be executed whenever a particular condition occurs. In general:</p><pre class="border">EXEC SQL WHENEVER condition action END-EXEC.</pre><p>condition can be one of the following:</p><dl><dt class="em">SQLERROR</dt><dd><p>The specified action is called whenever an error occurs during the execution of an SQL statement.</p></dd></dl><dl><dt class="em">SQLWARNING</dt><dd><p>The specified action is called whenever a warning occurs during the execution of an SQL statement.</p></dd></dl><dl><dt class="em">NOT FOUND</dt><dd><p>The specified action is called whenever an SQL statement retrieves or affects zero rows. (This condition is not an error, but you might be interested in handling it specially.)</p><br></dd></dl><p>action can be one of the following:</p><dl><dt class="em">CONTINUE</dt><dd><p>This effectively means that the condition is ignored. This is the default.</p></dd></dl><dl><dt class="em">GOTO label<br>GO TO label</dt><dd><p>Jump to the specified label (using a COBOL goto statement).</p></dd></dl><dl><dt class="em">SQLPRINT</dt><dd><p>Print a message to standard error. This is useful for simple programs or during prototyping. The details of the message cannot be configured.</p></dd></dl><dl><dt class="em">STOP</dt><dd><p>Call STOP, which will terminate the program.</p></dd></dl><dl><dt class="em">CALL name usingargs<br>DO name usingargs</dt><dd><p>Call the specified functions with the following characters including arguments. Thus, syntaxes (including compiler depending) are able to be placed as well as the arguments. Though, there are some limitation as following:</p><ul><li><p>You can't use RETURNING, ON EXCEPTION or OVER FLOW clauses.</p></li><li><p>In the called subprogram, you must specify CONTINUE for every action with WHENEVER statement.</p><br></li></ul></dd></dl><p>The SQL standard only provides for the actions CONTINUE and GOTO (and GO TO).</p><p>Here is an example that you might want to use in a simple program. It prints a simple message when a warning occurs and aborts the program when an error happens:</p><pre class="border">EXEC SQL WHENEVER SQLWARNING SQLPRINT END-EXEC.EXEC SQL WHENEVER SQLERROR STOP END-EXEC.</pre><p>The statement EXEC SQL WHENEVER is a directive of the SQL preprocessor, not a COBOL statement. The error or warning actions that it sets apply to all embedded SQL statements that appear below the point where the handler is set, unless a different action was set for the same condition between the first EXEC SQL WHENEVER and the SQL statement causing the condition, regardless of the flow of control in the COBOL program. So neither of the two following COBOL program excerpts will have the desired effect:</p><pre class="border">**   WRONG*    ...    IF VERBOSE = 1 THEN        EXEC SQL WHENEVER SQLWARNING SQLPRINT END-EXEC    END-IF.    ...    EXEC SQL SELECT ... END-EXEC.    ...**   WRONG*    ...    CALL SET-ERROR-HANDLER.*        (and execute "EXEC SQL WHENEVER SQLERROR STOP" in SET-ERROR-HANDLER)    ...    EXEC SQL SELECT ... END-EXEC.    ...</pre><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2681-d-07-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-d-07-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>