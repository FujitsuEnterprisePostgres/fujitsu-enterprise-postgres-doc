<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>3.2.2 Registering ODBC Data Sources(for Windows(R))</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-00-03-00-00.html">Chapter&nbsp;3 ODBC Driver</a> &gt; <a href="j2681-00-03-02-00.html">3.2 Setup</a> &gt; 3.2.2 Registering ODBC Data Sources(for Windows(R))</div><div class="back_next"><a href="j2681-00-03-02-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-03-02-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_030202"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows">3.2.2 Registering ODBC Data Sources(for Windows(R))</h3><div class="body"><div class="textblock"><p>This section describes how to register ODBC data sources.</p><p>There are the following two ways to register ODBC data sources on Windows(R).</p><p></p></div></div><h4 id="mID_03020201">3.2.2.1 Registering Using GUI</h4><div class="body"><div class="textblock"><p>This section describes how to start the [ODBC Data Source Administrator] and register ODBC data sources.</p><p>Use the following procedure to register ODBC data sources:</p><ol><li><p>Start the [ODBC Data Source Administrator].</p><p>Select [Start] &gt;&gt; [Control Panel] &gt;&gt; [Administrative Tools] &gt;&gt; [ODBC Data Source Administrator]. </p><div class="note"><p class="title">Note</p><div class="notebody"><p>To register data sources for 32-bit applications in Windows(R) for 64-bit, execute the ODBC administrator (odbcad32.exe) for 32-bit, as shown below.</p><pre class="border">%SYSTEMDRIVE%\WINDOWS\SysWOW64\odbcad32.exe</pre></div></div><br></li><li><p>When only the current user is to use the ODBC data source, select [User DSN]. When all users using the same computer are to use the ODBC data source, select [System DSN].</p><br></li><li><p>Click [Add].</p><br></li><li><p>Select one of the following drivers from the list of available ODBC drivers displayed in [Create New Data Source], and then click [Finish]. The notation "<span class="i">x</span>" indicates the version of the FUJITSU Enterprise Postgres client feature.</p><ul><li><p>FUJITSU Enterprise Postgres Unicode <span class="i">x</span><br>Select this driver if using Unicode as the application encoding system.</p></li><li><p>FUJITSU Enterprise Postgres ANSI <span class="i">x</span><br>Select this driver if using other than Unicode as the application encoding system.</p></li></ul></li><li><p>The [PostgreSQL ANSI ODBC Driver (psqlODBC) Setup] window is displayed. Enter or select the required items, then click [Save].</p><p><img src="apl03img/e-0302020101-ansi-odbc.gif" alt="" width="526" height="267"></p><br><p>Set the following content:</p><table><col><col><tr><th valign="top"><p>Definition name</p></th><th valign="top"><p>Setting value</p></th></tr><tr><td align="left" valign="top"><p>Data Source</p></td><td align="left" valign="top"><p>Specify the data source name to be registered in the ODBC driver manager. The application will select the name specified here and connect with the FUJITSU Enterprise Postgres database. This parameter cannot be omitted. Specify the following characters up to 32 bytes.</p><ul><li><p>National characters</p></li><li><p>Alphanumerics</p></li><li><p> "_", "&lt;", "&gt;", "+", "`", "|", "~", "'" " "&amp;" , """, "#" , "$" , "%" , "-" , "^" , ":" , "/" , "."</p></li></ul></td></tr><tr><td align="left" valign="top"><p>Description</p></td><td align="left" valign="top"><p>Specify a supplementary description for the current data source. Specify characters up to 255 bytes.</p><ul><li><p>National characters</p></li><li><p>Alphanumerics</p></li></ul></td></tr><tr><td align="left" valign="top"><p>Database</p></td><td align="left" valign="top"><p>Specify the database name to be connected.</p></td></tr><tr><td align="left" valign="top"><p>SSLMode</p></td><td align="left" valign="top"><p>Specify to encrypt communications. The default is "disable".</p><p>The setting values for SSLMode are as follows:</p><ul><li><p>disable: Connect without SSL</p></li><li><p>allow: Connect without SSL, and if it fails, connect using SSL</p></li><li><p>prefer: Connect using SSL, and if it fails, connect without SSL</p></li><li><p>require: Connect always using SSL</p></li><li><p>verify-ca: Connect using SSL, and use a certificate issued by a trusted CA <span class="inline-note">*1</span></p></li><li><p>verify-full: Connect using SSL, and use a certificate issued by a trusted CA to verify if the server host name matches the certificate <span class="inline-note">*1</span></p></li></ul></td></tr><tr><td align="left" valign="top"><p>Server</p></td><td align="left" valign="top"><p>Specify the host name of the database server to connect to, using up to 63 bytes. This parameter cannot be omitted.</p></td></tr><tr><td align="left" valign="top"><p>Port</p></td><td align="left" valign="top"><p>Specify the port number to be used for remote access. The default value is "27500".</p></td></tr><tr><td align="left" valign="top"><p>Username<span class="inline-note">*2</span></p></td><td align="left" valign="top"><p>Specify the user that will access the database.</p></td></tr><tr><td align="left" valign="top"><p>Password<span class="inline-note">*2</span></p></td><td align="left" valign="top"><p>Specify the password for the user that will access the database.</p></td></tr></table><p>*1: If specifying either "verify-ca" or "verify-full", use the system environment variable PGSSLROOTCERT of your operating system to specify the CA certificate file as shown below.</p><p>Example:</p><pre class="border">Variable name: PGSSLROOTCERTVariable value: <span class="i">c</span><span class="i">A</span><span class="i">CertificateFile</span></pre><p>*2: In consideration of security, specify the Username and the Password by the application.</p></li></ol></div></div><h4 id="mID_03020202">3.2.2.2 Registering Using Commands</h4><div class="body"><div class="textblock"><p>This section describes how to use commands to register ODBC data sources.</p><p>Use the following tools from Microsoft to register ODBC data sources.</p><ul><li><p>ODBCConf.exe</p></li><li><p>Add-OdbcDsn</p></li></ul><p>Refer to the Microsoft Developer Network (MSDN) Library for information on how to use these tools.</p></div><p class="subhead_1" id="IDapl03N1"><span class="em">When using ODBCConf.exe</span><a name="N8G"></a><span class="em"></span></p><div class="textblock"><p>ODBCConf.exe is a tool supported on all Windows(R) platforms.</p><dl><dt class="em">Specification format</dt><dd><pre class="border">ODBCConf.exe /A {<span class="i"> dataSourceType</span> "<span class="i">o</span><span class="i">dbcDriverName</span>" "<span class="i">optionName</span>=<span class="i">value</span>[|<span class="i">optionName</span>=<span class="i">value</span>...]"} [/Lv <span class="i">fileName</span>]</pre><p>Refer to the Microsoft MSDN library for information on the format and parameters.</p></dd></dl><dl><dt class="em">Description</dt><dd><p>Set the following content:</p><table><col><col><tr><th valign="top"><p>Definition name</p></th><th valign="top"><p>Setting value</p></th></tr><tr><td align="left" valign="top"><p>Data source type</p></td><td align="left" valign="top"><p>Specify the data source type.</p><ul><li><p>"CONFIGSYSDSN": A system data source is created. This requires user admin rights. The data source can be used by all users of the same computer.</p></li><li><p>"CONFIGDSN": A user data source is created. The data source can be used by the current user only.</p></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><p>When CONFIGSYSDSN is specified as the data source type, it is necessary to execute the command in the command prompt in administrator mode.</p></div></div></td></tr><tr><td align="left" valign="top"><p>ODBC driver name</p></td><td align="left" valign="top"><p>Specify an ODBC driver name that has already been registered on the system.</p><p>Specify one of the following.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>The placeholders shown below are enclosed in angle brackets '&lt;&gt;' to avoid confusion with literal text. Do not include the angle brackets in the string.</p></div></div><ul><li><p>"FUJITSU Enterprise Postgres Unicode <span class="i">&lt;</span><span class="i">fujitsuEnterprisePostgresClientVers</span><span class="i">&gt;</span>"<br>Specify this driver name if using Unicode as the application encoding system.</p></li><li><p>"FUJITSU Enterprise Postgres ANSI <span class="i">&lt;</span><span class="i">fujitsuEnterprisePostgresClientVers</span><span class="i">&gt;</span>"<br>Specify this driver name if using other than Unicode as the application encoding system.</p></li></ul></td></tr><tr><td align="left" valign="top"><p>Option name</p></td><td align="left" valign="top"><p>The following items must be set:</p><ul><li><p>"DSN": Specify the data source name.</p></li><li><p>"Servername": Specify the host name for the database server.</p></li><li><p>"Port": Specify the port number for connection to the database</p></li><li><p>"Database": Specify the database name.</p></li></ul><p>Specify the following values as required:</p><ul><li><p>"UID": User ID</p></li><li><p>"Password": Password</p></li><li><p>"SSLMode": Specify to encrypt communications. The default is "disable". Refer to the SSLMode explanation in the table under step 5 of "<a href="j2681-00-03-02-02.html#mID_03020201">3.2.2.1 Registering Using GUI</a>" for information on how to configure SSLMode.</p></li></ul></td></tr><tr><td align="left" valign="top"><p>File Name</p></td><td align="left" valign="top"><p>You can output process information to a file when creating a data source. This operand can be omitted.</p></td></tr></table></dd></dl><div class="ex"><p class="title">Example</p><div class="exbody"><pre class="border">ODBCConf.exe /A {CONFIGSYSDSN "FUJITSU Enterprise Postgres Unicode 12" "DSN=odbcconf1|Servername=sv1|Port=27500|Database=db01|SSLMode=verify-ca"} /Lv log.txt</pre></div></div><div class="note"><p class="title">Note</p><div class="notebody"><p>In consideration of security, specify the UID and the Password by the application.</p></div></div></div><p class="subhead_1" id="IDapl03N2"><span class="em">When using Add-OdbcDsn</span><a name="N9G"></a><span class="em"></span><span class="em"> </span></p><div class="textblock"><p>Add-OdbcDsn is used in the PowerShell command interface.</p><dl><dt class="em">Specification format</dt><dd><pre class="border">Add-OdbcDsn <span class="i">data</span><span class="i">S</span><span class="i">ource</span><span class="i">N</span><span class="i">ame</span> -DriverName "<span class="i">o</span><span class="i">dbcD</span><span class="i">river</span><span class="i">N</span><span class="i">ame</span>" -DsnType <span class="i">data</span><span class="i">S</span><span class="i">ource</span><span class="i">T</span><span class="i">ype</span> -Platform <span class="i">o</span><span class="i">S</span><span class="i">A</span><span class="i">rchitecture</span> -SetPropertyValue @("<span class="i">option</span><span class="i">N</span><span class="i">ame=value</span>" [,"<span class="i">option</span><span class="i">N</span><span class="i">ame=value</span>"...])</pre><p>Refer to the Microsoft MSDN library for information on the format and parameters.</p></dd></dl><dl><dt class="em">Description</dt><dd><p>Set the following content:</p><table><col><col><tr><th valign="top"><p>Definition name</p></th><th valign="top"><p>Setting value</p></th></tr><tr><td align="left" valign="top"><p>Data source name</p></td><td align="left" valign="top"><p>Specify any name for the data source name.</p></td></tr><tr><td align="left" valign="top"><p>ODBC driver name</p></td><td align="left" valign="top"><p>Specify an ODBC driver name that has already been registered on the system. Specify one of the following.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>The placeholders shown below are enclosed in angle brackets '&lt;&gt;' to avoid confusion with literal text. Do not include the angle brackets in the string.</p></div></div><ul><li><p>"FUJITSU Enterprise Postgres Unicode <span class="i">&lt;</span><span class="i">fujitsuEnterprisePostgresClientVers</span><span class="i">&gt;</span>"<br>Specify this driver name if using Unicode as the application encoding system.</p></li><li><p>"FUJITSU Enterprise Postgres ANSI <span class="i">&lt;</span><span class="i">fujitsuEnterprisePostgresClientVers</span><span class="i">&gt;</span>"<br>Specify this driver name if using other than Unicode as the application encoding system.</p></li></ul></td></tr><tr><td align="left" valign="top"><p>Data source type</p></td><td align="left" valign="top"><p>Specify the data source type.</p><ul><li><p>"System": A system data source is created. Requires user admin rights. The data source can be used by all users of the same computer.</p></li><li><p>"User": A user data source is created. The data source can be used by the current user only.</p></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><p>When System is specified as the data source type, it is necessary to execute the command in the administrator mode of the command prompt.</p></div></div></td></tr><tr><td align="left" valign="top"><p>OS architecture</p></td><td align="left" valign="top"><p>Specify the OS architecture of the system.</p><ul><li><p>"32-bit": 32-bit system</p></li><li><p>"64-bit": 64-bit system</p></li></ul></td></tr><tr><td align="left" valign="top"><p>Option name</p></td><td align="left" valign="top"><p>The following items must be set:</p><ul><li><p>"Servername": Specify the host name for the database server.</p></li><li><p>"Port": Specify the port number for connection to the database</p></li><li><p>"Database": Specify the database name.</p></li></ul><p>Specify the following values as required:</p><ul><li><p>"SSLMode": Specify to encrypt communications. The default is "disable". Refer to the SSLMode explanation in the table under step 5 of "<a href="j2681-00-03-02-02.html#mID_03020201">3.2.2.1 Registering Using GUI</a><span class="blue"><span class="u">"</span></span> for information on how to configure SSLMode.</p></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><p>When using Add-OdbcDsn, the strings "UID" and "Password" cannot be set as option names. These can only be used when using ODBCConf.exe.</p></div></div></td></tr></table></dd></dl><div class="ex"><p class="title">Example</p><div class="exbody"><pre class="border">Add-OdbcDsn odbcps1 -DriverName "FUJITSU Enterprise Postgres Unicode 12" -DsnType System -Platform 32-bit -SetPropertyValue @("Servername=sv1", "Port=27500", "Database=db01", "SSLMode=verify-ca")</pre></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2681-00-03-02-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-03-02-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>