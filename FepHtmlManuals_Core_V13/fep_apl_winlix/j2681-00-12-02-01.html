<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>12.2.1 Designing</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-00-12-00-00.html">Chapter&nbsp;12 Scan Using a Vertical Clustered Index (VCI)</a> &gt; <a href="j2681-00-12-02-00.html">12.2 Usage</a> &gt; 12.2.1 Designing</div><div class="back_next"><a href="j2681-00-12-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-12-02-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_130201">12.2.1 Designing</h3><div class="body"><div class="textblock"><p>Design as follows before using a VCI.</p><ul><li><p><a href="j2681-00-12-02-01.html#mID_130201_sql"><span class="u">E</span><span class="u">xecution multiplicity and number of parallel processes</span></a></p></li><li><p><a href="j2681-00-12-02-01.html#mID_130201_parameter"><span class="u">Parameters</span></a></p></li></ul><dl><dt class="em" id="mID_130201_sql">Execution multiplicity and number of parallel processes</dt><dd><p>Determine the maximum number of SQL statements that can be executed simultaneously and the number of parallel processes based on the number of CPU cores that can be allocated for scans that use VCI to perform aggregate processing. Design in advance the multiplicity of SQL statements for executing scans that use VCI and the number of parallel processes for scans that use VCI.</p><p>For example, if the number of CPUs that can be allocated is 32 cores, then the maximum number of SQL statements that can be executed simultaneously is 8 and the number of parallel processes is 4.</p><div class="note"><p class="title">Note</p><div class="notebody"><div id="lix" class="spcl_note_list2"><div class="spcl_body"><p><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span>A temporary file is created in /dev/shm or in a directory specified for the vci.smc_directory parameter as the dynamic shared memory for each SQL statement during a scan using a VCI.</p></div></div><div id="win" class="spcl_note_list2"><div class="spcl_body"><p><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span>A temporary file is created in a directory under the data storage directory or in a directory specified for the vci.smc_directory parameter as the dynamic shared memory for each SQL statement during a scan using a VCI.</p></div></div><p>Ensure that this directory has sufficient space to meet the memory requirements estimated for the execution multiplicity and number of parallel processes of SQL statements (refer to "Memory used per scanning" in "VCI Memory Requirements" in the Installation and Setup Guide for Server for details). If it does not have sufficient space when a scan is performed, SQL statements will return errors due to the insufficient memory.</p></div></div></dd></dl><dl><dt class="em" id="mID_130201_parameter">Parameters</dt><dd><p>The VCI parallel scan feature cannot be used for setting parameters immediately after creating an instance.</p><p>Therefore, set the parameters below based on the values determined in "Execution multiplicity and number of parallel processes of SQL statements" above.</p><table><col><col><col><col><tr><th valign="top"><p>Parameter name</p></th><th valign="top"><p>Description</p></th><th valign="top"><p>Default</p></th><th valign="top"><p>Value index</p></th></tr><tr><td align="left" valign="top"><p>vci.max_parallel_degree</p></td><td align="left" valign="top"><p>Maximum number of VCI parallel processes (background processes) to be used per SQL statement.</p></td><td align="left" valign="top"><p>0</p></td><td align="left" valign="top"><p>Specify the number of parallel processes.</p></td></tr><tr><td align="left" valign="top"><p>vci.smc_directory</p></td><td align="left" valign="top"><p>Directory name in which a temporary file is created as the dynamic shared memory during a scan using a VCI.</p></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux">/dev/shm</p></div><div class="spcl_body"><p class="win_spcl_cont"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows">A directory (<span class="i">dataStorageDir</span>\\base\\pgsql_tmp) under the data storage directory</p></div></td><td align="left" valign="top"><p>Specify a directory that has enough free space for the memory used for each query during the scan.</p></td></tr><tr><td align="left" valign="top"><p>max_worker_processes</p></td><td align="left" valign="top"><p>Maximum number of background processes that the system supports.</p></td><td align="left" valign="top"><p>8</p></td><td align="left" valign="top"><p>Add the value of the maximum number of SQL statements that can be executed simultaneously for scans that use VCI multiplied by vci.max_parallel_degree.</p></td></tr></table><div class="ref"><p class="title">See</p><div class="refbody"><p>Refer to "Parameters" in the Operation Guide for information on the details of and how to set the parameters.</p></div></div></dd></dl><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2681-00-12-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-12-02-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>