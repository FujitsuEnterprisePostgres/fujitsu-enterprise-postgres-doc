<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>7.4.2 Compiling Applications</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-00-07-00-00.html">Chapter&nbsp;7 Embedded SQL in COBOL</a> &gt; <a href="j2681-00-07-04-00.html">7.4 Application Development</a> &gt; 7.4.2 Compiling Applications</div><div class="back_next"><a href="j2681-00-07-04-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-07-04-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_060402_cob">7.4.2 Compiling Applications</h3><div class="body"><div class="textblock"><p>Append the extension "pco" to the name of the source file for the embedded SQL in COBOL.</p><p>When the pco file is precompiled using the ecobpg command, COBOL source files will be created, so use the COBOL compiler for the compile.</p><p></p></div><p class="subhead_1" id="IDapl06-for-cobolN6"><span class="em">Precompiling example</span><a name="N36G"></a></p><div class="textblock"><pre class="border">ecobpg testproc.pco</pre><br><p>For COBOL code notation, "fixed" or "variable" format can be specified as an ecobpg command option. If not specified, "fixed" format is used.</p><p>Refer to "<a href="j2681-d-01-00.html">D.1 Precautions when Using Functions and Operators</a>" and "<a href="j2681-d-12-01.html">D.12.1 ecobpg</a>" for information on COBOL code notation and how to specify options for ecobpg.</p><p>If an optimizer hint block comment is specified for the SQL statement, specify the following option in the ecobpg command:</p><dl><dt class="em">--enable-hint</dt><dd><p>Enables the optimizer hint block comment (hereafter, referred to as the "hint clause"). If this option is not specified, the hint clause will be removed as a result of the ecobpg precompile and be disabled.</p><p>The SQL statements that can be specified in the hint clause are SELECT, INSERT, UPDATE, and DELETE.</p><p>The locations in which the hint clause can be specified are immediately after one of the SELECT, INSERT, UPDATE, DELETE, or WITH keywords. A syntax error will occur if it is specified in any other location.</p><dl><dt class="em">Example of specifying the hint clause<a name="N37G"></a></dt><dd><pre class="border">EXEC SQL SELECT /*+ IndexScan(prod ix01) */ name_id INTO :name_id FROM prod WHERE id = 1 END-EXEC.</pre></dd></dl><p>Refer to "<a href="j2681-00-11-01-01.html">11.1.1 Optimizer Hints</a>" for information on optimizer hints.</p></dd></dl><p>If the encoding used for embedded SQL source files differs from that of the locale when precompiling was executed, set the encoding for the embedded SQL source files by specifying the following option for ecobpg.</p><dl><dt class="em">-E-encode</dt><dd><p>Specify "UTF8", "SJIS", or "EUC_JP".</p><p>If this option is omitted, the encoding is processed based on the locale.</p></dd></dl></div><p class="subhead_1" id="IDapl06-for-cobolN7"><span class="em">Path of </span><span class="em">the library file</span><a name="N38G"></a></p><div class="textblock"><p>The ecobpg command defines a group item "sqlca_t" to handle errors, which is defined in the library file stored in the following path:</p><div id="lix" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span>Linux</dt><dd><table id="lix_spcl_table" border="1" width="93%"><col><col><tr><th valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="em">Library </span><span class="em">file </span><span class="em">name</span></p></div></th><th valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="em">The storage destination of library file</span></p></div></th></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="i">SQLCA-COBOL.cob</span></p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="i">fujitsuEnterprisePostgresClientInstallDir</span>/include</p></div></td></tr></table></dd></dl></div></div><div id="win" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span>Windows(R) </dt><dd><table id="win_spcl_table" border="1" width="93%"><col><col><tr><th valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="em">Library </span><span class="em">file </span><span class="em">name</span></p></div></th><th valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="em">The storage destination of library file</span></p></div></th></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="i">SQLCA-COBOL.cob</span></p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="i">fujitsuEnterprisePostgresClientInstallDir</span>\include</p></div></td></tr></table></dd></dl></div></div><p>When the ecobpg command generates a COBOL file, it inserts a COPY statement with no options to copy the library file. Therefore, specify the path of the storage destination of library file when compiling. How to specify the path must conform to your compiler's specifications.</p><p>There is also a library file with the same contents without the extension"cob".</p><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>Refer "<a href="j2681-d-07-02.html">D.7.2 sqlca</a>&rdquo;for information on the sqlca_t.</p></div></div></div><p class="subhead_1" id="IDapl06-for-cobolN8"><span class="em">Libraries to use</span><a name="N39G"></a></p><div class="textblock"><p>The applications generated by ecobpg connect to PostgreSQL through the ECPG library. The ECPG library internally loads the libpq library.</p></div><p class="subhead_1" id="IDapl06-for-cobolN9"><span class="em">Path of library</span><a name="N40G"></a></p><div class="textblock"><p>Refer to "<a href="j2681-00-06-04-02.html">6.4.2 Compiling Applications</a>" for information on the location and name of the ECPG library. And Refer to " <a href="j2681-00-05-00-00.html">Chapter&nbsp;5 C Library (libpq)</a>" for information on the location and name of the libpq library.</p><p>The COBOL compiler provides the how to link various libraries, so be sure to specify the path and libraries according to the specifications of your compiler.</p></div><p class="subhead_1" id="IDapl06-for-cobolN10"><span class="em">Entry information of subprogram</span><a name="N41G"></a><span class="em"></span><span class="em"> </span></p><div class="textblock"><p>If you use the ECPG library with a dynamic program structure, copy the entry information stored below. For details, follow the specifications of your compiler.</p><div id="lix" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span>Linux</dt><dd><div id="lix" class="spcl"><div class="spcl_body"><pre class="border"><span class="i">fujitsuEnterprisePostgresClientInstallDir</span>/share/cobol_entry.info</pre></div></div></dd></dl></div></div><div id="win" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span>Windows(R)</dt><dd><div id="win" class="spcl"><div class="spcl_body"><pre class="border"><span class="i">fujitsuEnterprisePostgresClientInstallDir</span>\share\cobol_entry.info</pre></div></div></dd></dl></div></div><div class="ex"><p class="title">Example</p><div class="exbody"><p>The examples of compiling the applications that dynamically links the COBOL language library.<br>Note that "&lt;<span class="i">x</span>&gt;" indicates the product version.</p><div id="lix" class="spcl_note"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span>Linux</dt><dd><ul><li><div id="lix" class="spcl"><div class="spcl_body"><p>Linux 64-bit application:</p></div></div><div id="lix" class="spcl_note_pre3"><div class="spcl_body"><pre class="border">cobol -M  -o testproc -I/opt/fsepv&lt;<span class="i">x</span>&gt;client64/include -L/opt/fsepv&lt;<span class="i">x</span>&gt;client64/lib -lecpg -lpq testproc.cob</pre></div></div></li></ul></dd></dl></div></div><div id="win" class="spcl_note"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span>Windows(R)</dt><dd><div id="win" class="spcl"><div class="spcl_body"><p>The examples of compiling on a 64-bit operating system.</p></div></div><ul><li><div id="win" class="spcl"><div class="spcl_body"><p>64-bit application</p></div></div><div id="win" class="spcl_note_pre3"><div class="spcl_body"><pre class="border">&gt; SET LIB=%ProgramFiles%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client64\lib;%LIB%&gt; cobol -I "%ProgramFiles%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client64\include" -M testproc.cob&gt; link testproc.obj F4AGCIMP.LIB LIBCMT.LIB LIBECPG.LIB LIBPQ.LIB /OUT:testproc.exe</pre></div></div></li><li><div id="win" class="spcl"><div class="spcl_body"><p>32-bit application</p></div></div><div id="win" class="spcl"><div class="spcl_body"><p>[NetCOBOL V10.5 or earlier]</p></div></div><div id="win" class="spcl_note_pre3"><div class="spcl_body"><pre class="border">&gt; SET LIB=%ProgramFiles(x86)%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client32\lib;%LIB%&gt; cobol32 -I "%ProgramFiles(x86)%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client32\include" -M testproc.cob&gt; link testproc.obj LIBC.LIB F3BICIMP.LIB LIBECPG.LIB LIBPQ.LIB /OUT:testproc.exe </pre></div></div><div id="win" class="spcl"><div class="spcl_body"><p>[NetCOBOL V11.0 or later]</p></div></div><div id="win" class="spcl_note_pre3"><div class="spcl_body"><pre class="border">&gt; SET LIB=%ProgramFiles(x86)%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client32\lib;%LIB%&gt; cobol32 -I "%ProgramFiles(x86)%\Fujitsu\fsepv&lt;<span class="i">x</span>&gt;client32\include" -M testproc.cob&gt; link testproc.obj MSVCRT.LIB F3BICIMP.LIB LIBECPG.LIB LIBPQ.LIB /OUT:testproc.exe </pre></div></div></li></ul></dd></dl></div></div></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2681-00-07-04-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-07-04-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>