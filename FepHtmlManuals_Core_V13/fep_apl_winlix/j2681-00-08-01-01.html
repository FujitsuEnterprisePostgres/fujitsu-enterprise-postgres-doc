<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>8.1.1 CREATE TRIGGER</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Application Development Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2681-00-08-00-00.html">Chapter&nbsp;8 SQL References</a> &gt; <a href="j2681-00-08-01-00.html">8.1 Expanded Trigger Definition Feature</a> &gt; 8.1.1 CREATE TRIGGER</div><div class="back_next"><a href="j2681-00-08-01-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-08-01-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="IDapl06-sqlN1">8.1.1 CREATE TRIGGER</h3><div class="body"><div class="textblock"><p>In addition to features of PostgreSQL, triggers can be created with OR REPLACE option and DO option.</p><p></p></div><p class="subhead_1" id="IDapl06-sqlN2"><span class="em">Synopsis</span></p><div class="textblock"><pre>CREATE <span class="em">[ OR REPLACE ]</span> [ CONSTRAINT ] TRIGGER name { BEFORE | AFTER | INSTEAD OF } { event [ OR ... ] }    ON table_name    [ FROM referenced_table_name ]    [ NOT DEFERRABLE | [ DEFERRABLE ] [ INITIALLY IMMEDIATE | INITIALLY DEFERRED ] ]    [ REFERENCING { { OLD | NEW } TABLE [ AS ] transition_relation_name } [ ... ] ]    [ FOR [ EACH ] { ROW | STATEMENT } ]    [ WHEN ( condition ) ]    { EXECUTE { FUNCTION | PROCEDURE } function_name ( arguments )        | <span class="em">DO [ LANGUAGE lang_name ] code</span> }</pre><pre></pre></div><p class="subhead_1" id="IDapl06-sqlN3"><span class="em">Description</span></p><div class="textblock"><p>Refer to the PostgreSQL Documentation for information about CREATE TRIGGER. This section describes OR REPLACE option and DO option. </p><p>A trigger which is created with OR REPLACE option and DO option will be associated with the specified table or view and will execute the specified code by the specified procedural language of DO (unnamed code block) when certain events occur.</p></div><p class="subhead_1" id="IDapl06-sqlN4"><span class="em">Parameters</span></p><div class="textblock"><dl><dt class="em">OR REPLACE</dt><dd><p>If the specified trigger is not defined in the table, it defines a new trigger.<br>If the specified trigger is already defined in the table, the named trigger replaces existing trigger.</p></dd></dl><dl><dt class="em">code</dt><dd><p>When the certain events occur, it executes the code in a specified procedural language. The unnamed code block does not require a prior definition like a function. Syntax is same as procedural language.</p></dd></dl><dl><dt class="em">lang_name</dt><dd><p>The name of the language that the function is implemented in. Can be SQL, C, internal, or the name of a user-defined procedural language. The default is 'plpgsql'.</p><p>plpgsql is supported in CREATE TRIGGER.</p><br></dd></dl><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>A normal trigger cannot be replaced by a constraint trigger.</p></li><li><p>A constraint trigger cannot be replaced by a normal trigger.</p></li><li><p>A trigger defined with DO option cannot be replaced by a trigger defined with EXECUTE PROCEDURE option.</p></li><li><p>A trigger defined with EXECUTE PROCEDURE option cannot be replaced by a trigger defined with DO option.</p></li></ul></div></div></div><p class="subhead_1" id="IDapl06-sqlN5"><span class="em">Examples</span></p><div class="textblock"><p>It executes the code block that is specified by DO before the table is updated.<br>(Example that LANGUAGE is plpgsql)</p><pre class="border">CREATE TRIGGER check_update    BEFORE UPDATE ON accounts     FOR EACH ROW     DO $$BEGIN RETURN NEW; END;$$ ;</pre><br><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>When a trigger created with DO option, a new function is created internally. The name of function is "schema name"."on table name"_"trigger name"_TRIGPROC(serial number).</p></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2681-00-08-01-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2681-00-08-01-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>