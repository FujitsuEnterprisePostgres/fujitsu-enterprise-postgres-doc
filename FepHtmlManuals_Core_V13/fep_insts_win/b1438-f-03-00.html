<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>F.3 VCI Memory Requirements</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Installation and Setup Guide for Server</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1438-f-00-00.html">Appendix&nbsp;F Estimating Memory Requirements</a> &gt; F.3 VCI Memory Requirements</div><div class="back_next"><a href="b1438-f-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1438-f-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="IDinsts0hN5">F.3 VCI Memory Requirements</h2><div class="body"><div class="textblock"><p>This section describes the formula for estimating VCI memory requirements.</p><p>Use the following formula to obtain a rough estimate of memory requirements:</p><pre class="border"><span class="i">memUsedByVci</span> = <span class="i">memForData</span> + <span class="i">mem</span><span class="i">For</span><span class="i">EachProcess</span></pre><br><p></p></div><p class="subhead_1" id="IDinsts0hN6"><span class="em">Memory required to store data </span><span class="em">in</span><span class="em"> memory</span></p><div class="textblock"><p>Secure the space estimated using the formula below on the stable buffer (part of shared_buffers).</p><pre class="border"><span class="i">memForData</span><span class="i"> =</span> (<span class="i">numOfRowsInTables</span>) x (<span class="i">numOfBytesPerRow</span>) + (<span class="i">wosSize</span>)</pre><dl><dt class="em">Number of bytes per row</dt><dd><pre class="border"><span class="i">numOfBytesPerRow</span> <span class="i">=</span> (19 + (<span class="i">numOfColsInCreateIndexStatement</span>) / 8 + (<span class="i">numOfBytes</span><span class="i">PerSingleColValue</span>)) x 1.1</pre><p class="supple">Note: Round up the result to the nearest integer.</p></dd></dl><dl><dt class="em">WOS size</dt><dd><pre class="border"><span class="i">wosSize</span> = (<span class="i">numOfWosRows</span>) / 185 x 8096</pre><p>One row is added to the number of WOS rows for each INSERT and DELETE, and two rows are added for UPDATE. On the other hand, the number decreases to 520,000 rows or less during conversion to ROS performed by the ROS control daemon.</p><br></dd></dl></div><p class="subhead_1" id="IDinsts0hN7"><span class="em">Memory required for each process</span></p><div class="textblock"><pre class="border"><span class="i">memForEachProcess</span> <span class="i">=</span> <span class="i">memUsed</span><span class="i">Per</span><span class="i">Scanning</span> + <span class="i">memUsedForVciMaintenace</span> + <span class="i">memUsedByCreateIndexStatement</span></pre><dl><dt class="em">Memory used per scanning</dt><dd><ul><li><p>Parallel scan</p><pre class="border"><span class="i">memUsed</span><span class="i">Per</span><span class="i">Scanning</span>  = vci.shared_work_mem + (<span class="i">numOfParallelWorkers</span> + 1) x vci.maintenance_work_mem</pre><p class="supple">Note: The number of parallel workers used by VCI simultaneously in the entire instance is equal to or less than vci.max_parallel_degree.</p></li><li><p>Non-parallel scan</p><pre class="border"><span class="i">memUsed</span><span class="i">Per</span><span class="i">Scanning</span> = vci.max_local_ros + vci.maintenance_work_mem</pre></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>vci.shared_work_mem, and vci.max_local_ros are used to create local ROS. If local ROS exceeds these sizes, execute a query without using VCI according to the conventional plan.</p></li><li><p>vci.maintenance_work_mem specifies the memory size to be secured dynamically. If it exceeds the specified value, a disk temporary file is used for operation.</p></li></ul></div></div></dd></dl><dl><dt class="em">Memory used for VCI maintenance</dt><dd><pre class="border"><span class="i">memUsedForVciMaintenace</span> = vci.maintenance_work_mem x vci.control_max_workers</pre></dd></dl><dl><dt class="em">Memory used by CREATE INDEX</dt><dd><pre class="border"><span class="i">memUsedByCreateIndexStatement</span> = vci.maintenance_work_mem</pre><div class="note"><p class="title">Note</p><div class="notebody"><p>vci.maintenance_work_mem specifies the memory to be secured dynamically. If it exceeds the specified value, a disk temporary file is used for operation.</p></div></div></dd></dl></div></div><div class="header_footer"><div class="back_next"><a href="b1438-f-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1438-f-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>