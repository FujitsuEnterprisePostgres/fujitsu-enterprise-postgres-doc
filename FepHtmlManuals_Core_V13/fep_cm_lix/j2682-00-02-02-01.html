<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>2.2.1 Configuring postgresql.conf</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Connection Manager User's Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2682-00-02-00-00.html">Chapter&nbsp;2 Setting Up</a> &gt; <a href="j2682-00-02-02-00.html">2.2 Setting Up the Server Side</a> &gt; 2.2.1 Configuring postgresql.conf</div><div class="back_next"><a href="j2682-00-02-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2682-00-02-02-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="IDchap02N8">2.2.1 Configuring postgresql.conf<a name="N21G"></a></h3><div class="body"><div class="textblock"><p>Describes the postgresql.conf parameters that must be set when using the Connection Manager.</p><p></p></div><p class="subhead_1" id="IDchap02N9"><span class="em">Parameters to Set</span></p><div class="textblock"><dl><dt class="em">max_connections<a name="N22G"></a></dt><dd><p>An existing PostgreSQL parameter. Add 2 to the value already set.</p><p>Connection to the instance is maintained from the time the instance is started to do the following:</p><ul><li><p>The watchdog process checks the state of the instance.</p></li><li><p>The terminator process forces the client to terminate the SQL connection.</p></li></ul></dd></dl><dl><dt class="em">shared_preload_libraries<a name="N23G"></a></dt><dd><p>An existing PostgreSQL parameter. Add a watchdog.</p><p>The watchdog process and terminator process start when you add watchdog and restart the instance.</p></dd></dl><dl><dt class="em" id="watchdogport">watchdog.port<a name="N24G"></a> (integer)</dt><dd><p>Specify the port number on which the watchdog process accepts connections for heartbeat monitoring from the conmgr process.</p><p>The value must be greater than or equal to 1 and less than or equal to 65535. The default is 27545. The instance must be restarted for this parameter change to take effect.</p></dd></dl><dl><dt class="em">watchdog.check_status_interval<a name="N25G"></a> (integer)</dt><dd><p>Specify the interval between checking the attributes of a instance.</p><p>watchdog process immediately notifies the conmgr process if the attribute changes.</p><p>The unit is milliseconds. Specify a value equal to or more than 1 millisecond. The default is 1000 milliseconds. The instance must be restarted for this parameter change to take effect.</p></dd></dl><dl><dt class="em">watchdog.max_hb_connections<a name="N26G"></a> (integer)</dt><dd><p>Specify the maximum number of conmgr processes that connect to watchdog process.</p><p>The default is the value specified in max_connections of postgresql.conf.</p><p>There is no upper limit, but about 200 bytes of memory are consumed for 1 connection when PostgreSQL is started.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>Normally you do not need to consider, but if you have a heartbeat connection with a very large number of conmgr processes, it may violate on the maximum number of file descriptors (You can check it with -n of the ulimit command.) of the OS user limit. This is because the socket for the heartbeat connection consumes the file descriptor. Set the maximum number of file descriptors of the OS user limit to a value larger than the value calculated below from the max_files_per_process parameter value and watchdog.max_hb_connections parameter value in postgresql.conf.</p><pre class="border">max_files_per_process + watchdog.max_hb_connections x 2</pre></div></div><br></dd></dl></div></div><div class="header_footer"><div class="back_next"><a href="j2682-00-02-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2682-00-02-02-02.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2020-2021 FUJITSU LIMITED </div></div></body></html>