<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>B.3.2 pgx_create_confidential_policy</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2677-b-00-00.html">Appendix&nbsp;B System Administration Functions</a> &gt; <a href="j2677-b-03-00.html">B.3 Data Masking Control Functions</a> &gt; B.3.2 pgx_create_confidential_policy</div><div class="back_next"><a href="j2677-b-03-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-b-03-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="br0B3_pgx_create_confidential_policy">B.3.2 pgx_create_confidential_policy</h3><div class="body"><div class="textblock"><p></p></div><p class="subhead_1" id="ID0b000000N13"><span class="em">Description</span></p><div class="textblock"><p>Creates masking policies</p></div><p class="subhead_1" id="ID0b000000N14"><span class="em">Format</span></p><div class="textblock"><p>The format varies depending on the masking type. The format is shown below.</p><pre>pgx_create_confidential_policy([schema_name		:= '<span class="i">schema</span><span class="i">N</span><span class="i">ame</span>',]table_name		:= '<span class="i">table</span><span class="i">N</span><span class="i">ame</span>',policy_name 		:= '<span class="i">policy</span><span class="i">N</span><span class="i">ame</span>',expression		:= '<span class="i">expr</span>'[, enable			:= '<span class="i">policyStatus</span>'][, policy_description	:= '<span class="i">policy</span><span class="i">D</span><span class="i">esc</span>'][, column_name		:= '<span class="i">col</span><span class="i">N</span><span class="i">ame</span>'	 [, function_type	:= 'FULL'] |	 [, function_type	:= 'PARTIAL', <span class="i">partial</span><span class="i">O</span><span class="i">pt</span>] |	 [, function_type	:= 'REGEXP', <span class="i">regexp</span><span class="i">O</span><span class="i">pt</span>]	 [, column_description	:= '<span class="i">col</span><span class="i">D</span><span class="i">esc</span>']])</pre><pre></pre><pre><span class="i">partial</span><span class="i">O</span><span class="i">pt</span>: function_parameters	:= '<span class="i">maskingFmt</span>'</pre><pre></pre><pre><span class="i">regexp</span><span class="i">O</span><span class="i">pt</span>: regexp_pattern		:= '<span class="i">regexp</span><span class="i">P</span><span class="i">attern</span>',regexp_replacement		:= '<span class="i">regexp</span><span class="i">R</span><span class="i">eplacement</span><span class="i">Char</span>',[, regexp_flags		:= '<span class="i">regexp</span><span class="i">F</span><span class="i">lags</span>']</pre></div><p class="subhead_1" id="ID0b000000N15"><span class="em">Argument</span></p><div class="textblock"><p>Details are as follows.</p><table><col><col><col><col><col><tr><th valign="top"><p>Masking type for which an argument can be specified</p></th><th valign="top"><p>Argument</p></th><th valign="top"><p>Data type</p></th><th valign="top"><p>Description</p></th><th valign="top"><p>Default value</p></th></tr><tr><td rowspan="9" align="left" valign="top"><p>All</p></td><td align="left" valign="top"><p>schema_name</p></td><td align="left" valign="top"><p>varchar(63)</p></td><td align="left" valign="top"><p>Schema name of table for which the masking policy is created</p></td><td align="left" valign="top"><p>'public'</p></td></tr><tr><td align="left" valign="top"><p>table_name</p></td><td align="left" valign="top"><p>varchar(63)</p></td><td align="left" valign="top"><p>Name of table for which the masking policy is created</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>policy_name</p></td><td align="left" valign="top"><p>varchar(63)</p></td><td align="left" valign="top"><p>Masking policy name</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>expression</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Masking condition</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>enable</p></td><td align="left" valign="top"><p>boolean</p></td><td align="left" valign="top"><p>Masking policy status</p><ul><li><p>'t': Enabled</p></li><li><p>'f': Disabled</p></li></ul></td><td align="left" valign="top"><p>'t'</p></td></tr><tr><td align="left" valign="top"><p>policy_description</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Masking policy description</p></td><td align="left" valign="top"><p>NULL</p></td></tr><tr><td align="left" valign="top"><p>column_name</p></td><td align="left" valign="top"><p>varchar(63)</p></td><td align="left" valign="top"><p>Masking target name</p></td><td align="left" valign="top"><p>NULL</p></td></tr><tr><td align="left" valign="top"><p>function_type</p></td><td align="left" valign="top"><p>varchar(63)</p></td><td align="left" valign="top"><p>Masking type</p><ul><li><p>'FULL': Full masking</p></li><li><p>'PARTIAL': Partial masking</p></li><li><p>'REGEXP': Regular expression masking</p></li></ul></td><td align="left" valign="top"><p>'FULL'</p></td></tr><tr><td align="left" valign="top"><p>column_description</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Masking target description</p></td><td align="left" valign="top"><p>NULL</p></td></tr><tr><td align="left" valign="top"><p>Partial masking</p></td><td align="left" valign="top"><p>function_parameters</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Masking format for partial masking</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td rowspan="3" align="left" valign="top"><p>Regular expression masking</p></td><td align="left" valign="top"><p>regexp_pattern</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Search pattern for regular expression masking</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>regexp_replacement</p></td><td align="left" valign="top"><p>varchar(1024)</p></td><td align="left" valign="top"><p>Replacement character/string for regular expression masking</p></td><td align="left" valign="top"><p>Mandatory</p></td></tr><tr><td align="left" valign="top"><p>regexp_flags</p></td><td align="left" valign="top"><p>varchar(20)</p></td><td align="left" valign="top"><p>Regular expression flags</p></td><td align="left" valign="top"><p>NULL</p></td></tr></table><p>Details about whether arguments can be omitted are as follows.</p><table><col><col><col><col><tr><th rowspan="2" valign="top"><p>Argument</p></th><th colspan="3" valign="top"><p>Mandatory or optional</p></th></tr><tr><th valign="top"><p>Full masking</p></th><th valign="top"><p>Partial masking</p></th><th valign="top"><p>Regular expression masking</p></th></tr><tr><td align="left" valign="top"><p>schema_name</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>table_name</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td></tr><tr><td align="left" valign="top"><p>policy_name</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td></tr><tr><td align="left" valign="top"><p>expression</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>N</p></td></tr><tr><td align="left" valign="top"><p>enable</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>policy_description</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>column_name</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>function_type</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>column_description</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td><td align="left" valign="top"><p>Y</p></td></tr><tr><td align="left" valign="top"><p>function_parameters</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>N</p></td><td align="left" valign="top"><p>-</p></td></tr><tr><td align="left" valign="top"><p>regexp_pattern</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>N</p></td></tr><tr><td align="left" valign="top"><p>regexp_replacement</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>N</p></td></tr><tr><td align="left" valign="top"><p>regexp_flags</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>Y</p></td></tr></table><p class="supple">Y: Can be omitted;  N: Cannot be omitted;  -: Ignored when specified</p></div><p class="subhead_1" id="ID0b000000N16"><span class="em">Return value</span></p><div class="textblock"><table><col><col><tr><th valign="top"><p>Return value</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>TRUE</p></td><td align="left" valign="top"><p>Ended normally</p></td></tr><tr><td align="left" valign="top"><p>FALSE</p></td><td align="left" valign="top"><p>Ended abnormally</p></td></tr></table></div><p class="subhead_1" id="ID0b000000N17"><span class="em">Execution example 1</span></p><div class="textblock"><p>Creating masking policy p1 that does not contain a masking target</p><pre class="border">postgres=# select pgx_create_confidential_policy(table_name := 't1', policy_name := 'p1', expression := '1=1'); pgx_create_confidential_policy --------------------------------- t(1 row)</pre></div><p class="subhead_1" id="ID0b000000N18"><span class="em">Execution example 2</span></p><div class="textblock"><p>Creating masking policy p1 that contains masking target c1 of which the masking type is full masking</p><pre class="border">postgres=# select pgx_create_confidential_policy(schema_name := 'public', table_name := 't1', policy_name := 'p1', expression := '1=1', enable := 't', policy_description := 'this policy is an example.', column_name := 'c1', function_type := 'FULL', column_description := 'c1 column is FULL.'); pgx_create_confidential_policy --------------------------------- t(1 row)</pre></div><p class="subhead_1" id="ID0b000000N19"><span class="em">Execution example 3</span></p><div class="textblock"><p>Creating masking policy p1 that contains masking target c2 of which the masking type is partial masking</p><pre class="border">postgres=# select pgx_create_confidential_policy( table_name := 't1', policy_name := 'p1', expression := '1=1', column_name := 'c2', function_type := 'PARTIAL', function_parameters := 'VVVFVVVVFVVVV, VVV-VVVV-VVVV, *, 4, 11'); pgx_create_confidential_policy --------------------------------- t(1 row)</pre></div><p class="subhead_1" id="ID0b000000N20"><span class="em">Execution example 4</span></p><div class="textblock"><p>Creating masking policy p1 that contains masking target c3 of which the masking type is regular expression masking</p><pre class="border">postgres=# select pgx_create_confidential_policy( table_name := 't1', policy_name := 'p1', expression := '1=1', column_name := 'c3', function_type := 'REGEXP', regexp_pattern := '(.*)(@.*)', regexp_replacement := 'xxx\2', regexp_flags := 'g'); pgx_create_confidential_policy --------------------------------- t(1 row)</pre></div><p class="subhead_1" id="ID0b000000N21"><span class="em">Description</span></p><div class="textblock"><ul><li><p>The arguments for the pgx_create_confidential_policy system management function can be specified in any order.</p></li><li><p>If column_name is omitted, only masking policies that do not contain masking target will be created.</p></li><li><p>One masking policy can be created for each table. Use the pgx_alter_confidential_policy system management function to add a masking target to a masking policy.</p></li><li><p>The function_parameters argument is enabled when the function_type is PARTIAL. If the function_type is other than PARTIAL, it will be ignored.</p></li><li><p>The arguments below are enabled when the function_type is REGEXP. If the function_type is other than REGEXP, these arguments will be ignored.</p><ul><li><p>regexp_pattern</p></li><li><p>regexp_replacement</p></li><li><p>regexp_flags</p></li></ul></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><p>If a table for which a masking policy is to be applied is deleted, delete the masking policy as well.</p></div></div><div class="ref"><p class="title">See</p><div class="refbody"><ul><li><p>Refer to "String Constants" in the PostgreSQL Documentation for information on the strings to specify for arguments.</p></li><li><p>Refer to "POSIX Regular Expressions" in the PostgreSQL Documentation and check pattern, replacement, and flags for information on the values that can be specified for regexp_pattern, regexp_replacement, and regexp_flags.</p></li></ul></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2677-b-03-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-b-03-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>