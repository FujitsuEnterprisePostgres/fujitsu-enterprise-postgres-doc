<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>13.1.4 Performance Impact and Parameter Tuning of the Local Meta Cache Limit Feature</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2677-00-13-00-00.html">Chapter&nbsp;13 Local Meta Cache Limit</a> &gt; <a href="j2677-00-13-01-00.html">13.1 Usage </a> &gt; 13.1.4 Performance Impact and Parameter Tuning of the Local Meta Cache Limit Feature</div><div class="back_next"><a href="j2677-00-13-01-03.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-14-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_lm_0104">13.1.4 Performance Impact and Parameter Tuning of the Local Meta Cache Limit Feature</h3><div class="body"><div class="textblock"><p>By observing how much meta cache regeneration is taking place, you can determine if the low upper limit is the cause of the failure to achieve the desired performance.</p><p>From the message below, calculate the cache hit ratio as follows:</p><pre class="border">Cache hit ratio Ôºù Number of cache hits &divide; Number of times the cache was searched</pre><p>If the cache hit ratio is 80% or higher, this feature will not be the main factor that impedes performance. If not, raise the upper limit and see if performance can reach the goal. In doing so, first try to shift the focus of allocation to the relations cache. This is because when executing SQL, the relation cache generated based on the catalog cache is mainly referenced, so it is advantageous to leave a large amount of relation cache.</p><pre class="border">Catalog cache:catalog cache hit stats: search <span class="em"><span class="i"><span class="u">XX</span></span></span>, hits <span class="em"><span class="i"><span class="u">YY</span></span></span><span class="em"><span class="i"><br></span></span>Relation cache:relation cache hit stats: search <span class="em"><span class="i"><span class="u">XX</span></span></span>, hits <span class="em"><span class="i"><span class="u">YY</span></span></span></pre><p> (<span class="em"><span class="i"><span class="u">XX</span></span></span>: Number of times the cache was searched, <span class="em"><span class="i"><span class="u">YY</span></span></span>: Number of cache hits)</p><p>This message is printed when the transaction ends. However, if you output the message frequently, the performance will be degraded by itself, so you can adjust the output interval with the following parameters.</p><table><col><col><tr><th valign="top"><p>Parameter Name</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>pgx_cache_hit_log_interval</p></td><td align="left" valign="top"><p>When the transaction ends, if the time set in this parameter has elapsed since the previous message was output, the message is output.</p><p>If set to 0, a message will be output each time the transaction ends. Setting -1 disables the output. The default value is 10min.</p><p>Even if pgx_catalog_cache_max_size and pgx_relation_cache_max_size are disabled, the message output of the corresponding cache will be invalid.</p><p>Immediately after connecting to the server, a small transaction occurs before the request from the user application, such as for user authentication. Since it is meaningless to know the hit ratio for these, a message is output at the end of the transaction that started after the time set in this parameter has elapsed after connecting to the server.</p><p>For the same reason, setting a small value such as 0 may result in a message being printed at the end of such a small transaction.</p><p>You can check which transaction the message corresponds to from the information output at the beginning. This information depends on the setting of the parameter log_line_prefix.</p></td></tr></table><div class="ex"><p class="title">Example</p><div class="exbody"><p>Here is an example postgresql.conf configuration:</p><pre class="border">pgx_cache_hit_log_interval= 30min</pre></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2677-00-13-01-03.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-14-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>