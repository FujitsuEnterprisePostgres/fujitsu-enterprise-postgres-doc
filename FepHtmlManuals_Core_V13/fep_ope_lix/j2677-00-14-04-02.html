<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>14.4.2 Copy Command for Recovery</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2677-00-14-00-00.html">Chapter&nbsp;14 Backup/Recovery Using the Copy Command</a> &gt; <a href="j2677-00-14-04-00.html">14.4 Copy Command Interface</a> &gt; 14.4.2 Copy Command for Recovery</div><div class="back_next"><a href="j2677-00-14-04-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-15-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="br0d_copy0402">14.4.2 Copy Command for Recovery<a name="N90G"></a></h3><div class="body"><div class="textblock"><p></p></div><p class="subhead_1" id="ID0d00-copyN15"><span class="em">Feature</span></p><div class="textblock"><p>User exit (for the copy command) called from the pgx_rcvall command.</p></div><p class="subhead_1" id="ID0d00-copyN16"><span class="em">Format</span></p><div class="textblock"><p>The syntax for calling the copy command from the pgx_rcvall command is described below.</p><pre class="border"><span class="i">copyCommandName</span> restore<span class="i"> 'pathOfBackupInfoFile' 'pathOfBackupTargetListFile'</span></pre></div><p class="subhead_1" id="ID0d00-copyN17"><span class="em">Argument</span></p><div class="textblock"><ul><li><p>Operation mode</p><table><col><col><tr><th valign="top"><p>Mode</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>restore</p></td><td align="left" valign="top"><p>Performs restore.</p></td></tr></table></li><li><p>Full path of the backup information file</p><p>Full path of the backup information file, enclosed in single quotation marks.</p></li><li><p>Full path of the backup target list file</p><p>Full path of the file containing the resources to be restored using the copy command, enclosed in single quotation marks.</p></li></ul><p>The access permissions for the backup information file and backup target list file are as below.</p><table><col><col><tr><th valign="top"><p>Backup information file</p></th><th valign="top"><p>Backup target list file</p></th></tr><tr><td align="left" valign="top"><p>Can be viewed by the instance administrator only</p></td><td align="left" valign="top"><p>Can be viewed by the instance administrator only</p></td></tr></table></div><p class="subhead_1" id="ID0d00-copyN18"><span class="em">Return value</span></p><div class="textblock"><table><col><col><tr><th valign="top"><p>Return value</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>0</p></td><td align="left" valign="top"><p>Normal end</p><p>The pgx_rcvall command continues processing.</p></td></tr><tr><td align="left" valign="top"><p>Other than 0</p></td><td align="left" valign="top"><p>Abnormal end</p><p>The pgx_rcvall command terminates in error.</p></td></tr></table></div><p class="subhead_1" id="ID0d00-copyN19"><span class="em">Description</span></p><div class="textblock"><ul><li><p>The copy command operates with the privileges of the operating system user who executed the pgx_rcvall command. Therefore, grant copy command execution privileges to users who will execute the pgx_rcvall command. Additionally, have the copy command change users as necessary.</p></li><li><p>The copy command is called once only in restore mode.</p></li><li><p>To copy multiple resources simultaneously, have the copy command copy them in parallel.</p></li></ul><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>The backup information file and backup target list file cannot be deleted. Additionally, the privileges cannot be changed.</p></li><li><p>Standard output and standard error output of the copy command are output to the terminal where the pgx_rcvall command was executed.</p></li><li><p>If the copy command becomes unresponsive, the pgx_rcvall command will also become unresponsive. If the status of the copy command is deemed to be unresponsive by the operating system, use an operating system command to forcibly stop it.</p></li><li><p>Output the copy command execution trace and the result to a temporary file, so that if it terminates in error, the cause can be investigated at a later time.</p></li><li><p>Do not execute FUJITSU Enterprise Postgres commands or PostgreSQL applications in the copy command.</p></li><li><p>There may be files and directories not required for recovery using the archive log included in the backup, such as postmaster.pid, pg_wal/<span class="i">subdirectory</span> and pg_replslot in the database cluster. If such unnecessary files and directories exist, have the copy command delete them after the restore.</p></li></ul></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2677-00-14-04-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-15-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>