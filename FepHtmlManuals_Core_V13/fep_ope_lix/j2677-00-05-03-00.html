<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>5.3 Opening the Keystore</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2677-00-05-00-00.html">Chapter&nbsp;5 Protecting Storage Data Using Transparent Data Encryption</a> &gt; 5.3 Opening the Keystore</div><div class="back_next"><a href="j2677-00-05-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-05-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="br053000">5.3 Opening the Keystore<a name="N36G"></a></h2><div class="body"><div class="textblock"><p>To create encrypted tablespaces and access the encrypted data, you must first open the keystore. When you open the keystore, the master encryption key is loaded into the database server memory and becomes usable for encryption and decryption.</p><p>You need to open the keystore each time you start the instance. To open the keystore, the database superuser must execute the following SQL function.</p><pre class="border">SELECT pgx_open_keystore('passphrase');</pre><p>The value "passphrase" is the passphrase specified during creation of the keystore.</p><p>Refer to "<a href="j2677-b-02-00.html">B.2 Transparent Data Encryption Control Functions</a>" for information on the pgx_open_keystore function.</p><p>Note that, in the following cases, the passphrase must be entered when starting the instance, because the encrypted WAL must be decrypted for recovery. In this case, the above-mentioned pgx_open_keystore function cannot be executed.</p><ul><li><p>If performing crash recovery at the time of starting the instance</p></li><li><p>If performing recovery using continuous archiving</p></li></ul><p>For the above cases, specify the --keystore-passphrase option in the pg_ctl command, and then start the instance. This will display the prompt for the passphrase to be entered, as shown below.</p><pre class="border">&gt; pg_ctl --keystore-passphrase startEnter the passphrase: The server is starting&gt;</pre><div class="point"><p class="title">Point</p><div class="pointbody"><p>When using an automatically opening keystore, you do not need to enter the passphrase and you can automatically open the keystore when the database server starts. Refer to "<a href="j2677-00-05-06-03.html">5.6.3 Enabling Automatic Opening of the Keystore</a>" for details.</p></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2677-00-05-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2677-00-05-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>