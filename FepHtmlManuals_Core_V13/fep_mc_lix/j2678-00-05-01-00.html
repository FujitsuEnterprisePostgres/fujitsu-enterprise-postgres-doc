<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>5.1 Mirroring Controller Setup</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2678-00-05-00-00.html">Chapter&nbsp;5 Managing Mirroring Controller Using WebAdmin</a> &gt; 5.1 Mirroring Controller Setup</div><div class="back_next"><a href="j2678-00-05-00-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2678-00-05-02-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="stream_rep_use_WebAdmin_01">5.1 Mirroring Controller Setup</h2><div class="body"><div class="textblock"><p>Perform the following procedure to set up Mirroring Controller in a streaming replication cluster. </p><ol><li><p>In the [Instances] tab, select the standby instance on which Mirroring Controller needs to be set up.</p></li><li><p>Click <img src="clust06-mcimg/e-06-mc-button-mc-setup.gif" alt="" width="20" height="20">.</p></li><li><p>Enter the information for the Mirroring Controller to be set up.</p><p>In the example below, Mirroring Controller is being set up for the replication cluster having master instance "inst1" and standby instance "inst1s".</p><p><img src="clust06-mcimg/e-06-mc0101-mc-controller-setup-initial.gif" alt="" width="1336" height="685"></p><p>The instance name, host address and port of the master and standby instances are displayed for easy reference.</p><p>Enter the following items on master instance and on standby instance fields for Mirroring Controller setup, as shown in the above screenshot:</p><ul><li><p>[Enable automatic switch over]: Toggles the automatic switch/disconnection functionality. Select "Yes". The default is "No".</p></li><li><p>[Mirroring Controller management directory]: Directory where the Mirroring Controller configuration files will be stored. When the [Mirroring Controller management directory] is entered, WebAdmin will search the Mirroring Controller configuration files in the entered directory based on the [Data storage path] of the corresponding DB instance. If Mirroring Controller configuration files are found, the Mirroring Controller fields will be auto filled.</p></li><li><p> [Mirroring Controller port]: Port number of Mirroring Controller. Note that if the Windows firewall feature is enabled, you must enable the port number of Mirroring Controller. Refer to "<a href="j2678-e-02-00.html">E.2 Windows Firewall Settings</a>" for details.</p></li><li><p> [Heartbeat interval (milliseconds)]: Number of milliseconds between two consecutive heartbeat checks. The default is "800".</p></li><li><p>[Heartbeat timeout (seconds)]: Number of seconds for the heartbeat timeout. The default is "1".</p></li><li><p>[Heartbeat retry]: Number of retries for heartbeat monitoring, before failover occurs. The default is "2".</p></li><li><p>[Heartbeat error action]: Operation when a heartbeat abnormality is detected. The default is "Fallback".</p><p>When using FUJITSU Enterprise Postgres 10, 11 and 12 instances created with previous versions, the instances will be in compatibility mode, and the "Fallback" is preselected and cannot be changed in the [Heartbeat error action] for Mirroring Controller setup.</p><p>When setting up Mirroring Controller for FUJITSU Enterprise Postgres 9.5 and 9.6 instances, the [Heartbeat error action] is not supported and therefore is not displayed.</p><br></li></ul><p>When the [Heartbeat error action] is set to "Arbitration", the following extra items are displayed:</p><ul><li><p>[Arbitration network IP address]: IP address of the arbitration network.</p></li><li><p>[Mirroring Controller Arbitration port]: Port number of Mirroring Controller for communicating with the arbitration server.</p><br></li></ul><p>The [Arbitration server configuration] section is also displayed with the following items. The [Arbitration server configuration] will not be auto filled.</p><ul><li><p>[Location]: Location of the arbitration server. "Local" or "Remote" can be selected depending on your configuration.</p><p>If the arbitration server and WebAdmin server are located on the same server, you can select "Local" and the following items are displayed:</p><ul><li><p>[Arbitration management directory]: Directory where the arbitration server configuration files will be stored.</p></li><li><p>[Arbitration server host or IP address]: Host name or IP address of the arbitration server.</p></li><li><p>[Arbitration process port]: Port number for the arbitration process.</p></li><li><p>[Fencing command]: Full path of the fencing command that fences a database server when an abnormality is detected.</p></li></ul><p>If "Remote" is set for the item, the items below are displayed in addition to the above items.</p><ul><li><p>In the [Arbitration server configuration] section, [Operating system credential] is displayed where you can enter the following information:</p><p>[User name]: User name to access the arbitration server. </p><p>[Password]: Password to access the arbitration server.</p></li><li><p>In the [Remote WebAdmin for Arbitration server] section, the following items are displayed:</p><p>[Remote WebAdmin address]: IP address of the remote WebAdmin installed on the arbitration server. </p><p>[Remote WebAdmin port]: Port number for the WebAdmin installed on the arbitration server.</p><br></li></ul></li></ul><p>When the [Heartbeat error action] is set to "Command", the following extra items are displayed:</p><ul><li><p>[Arbitration command]: Full path of the arbitration command to be executed when an abnormality is detected.</p></li><li><p>[Fencing command]: Full path of the fencing command that fences a database server when an abnormality is detected.</p><br></li></ul></li><li><p>Click <img src="clust06-mcimg/e-06-mc-button-mc-setup-apply.gif" alt="" width="16" height="16"> to set up Mirroring Controller.</p></li><li><p>Upon successful completion, Mirroring Controller will be started on master and standby instances.</p><p>In the [Instances] tab, select standby instance. The page below is displayed, in which you can check the Mirroring Controller status. In the example below, standby instance "inst1s" is used.</p><p><img src="clust06-mcimg/e-06-mc0101-mc-controller-setup-completed.gif" alt="" width="1335" height="689"></p><br></li></ol><p>After the Mirroring Controller has been set up, <img src="clust06-mcimg/e-06-mc-button-mc-edit.gif" alt="" width="16" height="16"> ([Edit Mirroring Controller] button) and <img src="clust06-mcimg/e-06-mc-button-mc-configure.gif" alt="" width="16" height="16"> ([Mirroring Controller Configuration] button) are available. These buttons are displayed only when FUJITSU Enterprise Postgres 10 or later instances are created with FUJITSU Enterprise Postgres WebAdmin 13.</p><p>For FUJITSU Enterprise Postgres 9.5 and 9.6 instances, the [Heartbeat error action] will not be displayed.</p><p>When the [Heartbeat error action] is "Arbitration", the following information is displayed: whether the arbitration status is "online" or "offline", the arbitration server IP address and the arbitration process port.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>Operating system credential (User name, Password) should not contain hazardous characters. Refer to "<a href="j2678-f-00-00.html">Appendix&nbsp;F WebAdmin Disallow User Inputs Containing Hazardous Characters</a>".</p></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2678-00-05-00-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2678-00-05-02-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>