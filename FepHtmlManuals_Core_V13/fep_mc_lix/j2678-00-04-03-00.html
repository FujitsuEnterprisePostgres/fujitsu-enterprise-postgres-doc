<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>4.3 Action Required when Automatic Disconnection Fails</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2678-00-04-00-00.html">Chapter&nbsp;4 Action Required when an Error Occurs in Database Multiplexing Mode</a> &gt; 4.3 Action Required when Automatic Disconnection Fails</div><div class="back_next"><a href="j2678-00-04-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2678-00-04-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="mID_0803">4.3 Action Required when Automatic Disconnection Fails<a name="N104G"></a></h2><div class="body"><div class="textblock"><p>If the system behavior is unstable, for example there are insufficient system resources such as available memory or free disk space, automatic disconnection using Mirroring Controller may not be possible.</p><p>Perform the disconnection manually using one of the following methods:</p><ul><li><p>Refer to the procedures in "<a href="j2678-00-03-05-00.html">3.5 Manually Disconnecting the Standby Server</a>".</p></li><li><p>In the primary server, execute the mc_ctl command in detach mode to perform forced disconnection.</p><pre>Example)</pre><pre class="border">$ mc_ctl detach -M /mcdir/inst1</pre></li></ul><div class="point"><p class="title">Point</p><div class="pointbody"><ul><li><p>Even if connection cannot be established between database servers, it is possible to fence the standby server and forcibly disconnect by executing the mc_ctl command in detach mode.</p></li><li><p>In the cases below, stop Mirroring Controller and instances of the standby server database in advance so that the standby server is not fenced:</p><ul><li><p>The --no-fencing option is specified when performing forced disconnection.</p></li><li><p>The heartbeat_error_action parameter in <span class="i">serverIdentifier</span>.conf is set to "message" and the fencing command is not configured to be used (the fencing_command parameter is omitted in <span class="i">server</span><span class="i">I</span><span class="i">dentifier</span>.<span class="i">conf</span>).</p></li><li><p>The heartbeat_error_action parameter in <span class="i">serverIdentifier</span>.conf is set to "fallback".</p></li></ul></li></ul></div></div><div class="ref"><p class="title">See</p><div class="refbody"><p><span class="em">Recovery to database multiplexing mode</span></p><p>Refer to "<a href="j2678-00-04-01-02.html#mID_08010202">4.1.2.2 Rebuild the Standby Server</a>" for information on recovery to database multiplexing mode.</p></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2678-00-04-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2678-00-04-04-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>