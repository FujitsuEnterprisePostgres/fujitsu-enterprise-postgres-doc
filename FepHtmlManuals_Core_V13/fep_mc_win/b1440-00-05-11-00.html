<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>5.11 Performing Automatic Degradation Using the Arbitration Server</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1440-00-05-00-00.html">Chapter&nbsp;5 Managing Mirroring Controller Using WebAdmin</a> &gt; 5.11 Performing Automatic Degradation Using the Arbitration Server</div><div class="back_next"><a href="b1440-00-05-10-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-a-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="stream_rep_use_WebAdmin_09">5.11 Performing Automatic Degradation Using the Arbitration Server</h2><div class="body"><div class="textblock"><p>If database multiplexing is performed using WebAdmin, it is also possible to perform automatic degradation using the arbitration server. In such cases, it is necessary to perform tasks on the database server and the arbitration server after setting up Mirroring Controller in WebAdmin.</p><p></p></div><p class="subhead_1" id="IDclust06-mcN8"><span class="em">Tasks on the arbitration server</span></p><div class="textblock"><p>Perform setup of the arbitration server using Mirroring Controller commands.</p><ol><li><p>Set up the arbitration server.</p><p>Refer to "<a href="b1440-00-02-03-00.html">2.3 Setting Up the Arbitration Server</a>" in "<a href="b1440-00-02-00-00.html">Chapter&nbsp;2 Setting Up Database Multiplexing Mode</a>" for information on how to set up the arbitration server.</p></li></ol></div><p class="subhead_1" id="IDclust06-mcN9"><span class="em">Tasks on the database server</span></p><div class="textblock"><p>Change some of the settings after setting up Mirroring Controller in WebAdmin.</p><ol><li><p>Set up Mirroring Controller in WebAdmin.</p><p>Refer to "<a href="b1440-00-05-01-00.html">5.1 Mirroring Controller Setup</a>" for details.</p></li><li><p>Use WebAdmin to stop Mirroring Controller on the master and standby instances.</p><p>Refer to "<a href="b1440-00-05-04-00.html">5.4 Stopping Mirroring Controller</a>" for details.</p></li><li><p>Edit the network configuration file of the master and standby instances, and add the arbitration server information.</p><p>The network configuration file is network.conf, which exists in the Mirroring Controller management directory<span class="i"> </span>specified during Mirroring Controller setup. Refer to "<a href="b1440-a-03-00.html">A.3 Network Configuration File</a>" for details.</p><p>A definition example of network.conf is shown below.</p><pre>Example:The port number of the database server to be used as the arbitration network is set to "27541". The ID of the server of the Mirroring Controller arbitration process is set to "arbiter", and its port number is set to "27541".</pre><pre class="border">dbsvm27500 192.0.2.100<span class="u">,192.0.3.100</span> 27540<span class="u">,275</span><span class="u">41 </span><span class="u">server</span>dbsvs27500 192.0.2.110<span class="u">,</span><span class="u">192.0.3.110</span> 27540<span class="u">,</span><span class="u">275</span><span class="u">41 server</span><span class="u">arbiter 192.0.3.120 2</span><span class="u">7</span><span class="u">541 arbiter</span></pre><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Ensure that the port numbers set for the database server and the arbitration server do not conflict with other software. In addition, do not configure the same segment for the admin network and the arbitration network.</p></li><li><p>If the server type is "server", two IP addresses or host names, and two port numbers need to be specified in the following order:</p><ul><li><p>IP address or host name of the database server used as the admin network</p></li><li><p>IP address or host name of the database server used as the arbitration network</p></li><li><p>Port number of the database server used as the admin network</p></li><li><p>Port number of the database server used as the arbitration network</p></li></ul></li><li><p>If the server type is "arbiter", specify the IP address or host name set for the my_address parameter and the port number set for the port parameter in arbitration.conf of the arbitration server.</p></li><li><p>WebAdmin also support editing mirroring controller configuration via Use WebAdmin to edit Mirroring Controller configurations.<br>Refer to "<a href="b1440-00-05-02-00.html">5.2 Edit Mirroring Controller Setup</a>" for detailes.</p></li></ul></div></div></li><li><p>Edit the server configuration file of the master and standby instances, and add the parameters required for automatic degradation using the arbitration server.</p><p>The server configuration file is <span class="i">instanceName</span>.conf or<span class="i"> </span><span class="i">instancePort</span>.conf, which exists in the Mirroring Controller management directory specified during Mirroring Controller setup.</p><p>To perform automatic degradation using the arbitration server, set the heartbeat_error_action parameter to "arbitration".</p><p>Refer to "<a href="b1440-a-04-01.html">A.4.1 Server Configuration File for the Database Servers</a>" for information on other parameters.</p></li><li><p>Use WebAdmin to start Mirroring Controller on the master and standby instances.</p><p>Refer to "<a href="b1440-00-05-05-00.html">5.5 Starting Mirroring Controller</a>" for details.</p></li></ol></div><p class="subhead_1" id="IDclust06-mcN10"><span class="em">Common tasks</span></p><div class="textblock"><ol><li><p>Use the Mirroring Controller command to check the connection status from the database server or the arbitration server.</p><p>Refer to "<a href="b1440-00-02-08-00.html">2.8 Checking the Connection Status</a>" for information on how to check the connection status.</p></li></ol></div></div><div class="header_footer"><div class="back_next"><a href="b1440-00-05-10-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-a-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>