<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>2.11.3 Tuning to Stabilize Queries on the Standby Server (when Performing Frequent Updates on the Primary Server)</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1440-00-02-00-00.html">Chapter&nbsp;2 Setting Up Database Multiplexing Mode</a> &gt; <a href="b1440-00-02-11-00.html">2.11 Tuning</a> &gt; 2.11.3 Tuning to Stabilize Queries on the Standby Server (when Performing Frequent Updates on the Primary Server)</div><div class="back_next"><a href="b1440-00-02-11-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-02-11-04.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_060903">2.11.3 Tuning to Stabilize Queries on the Standby Server (when Performing Frequent Updates on the Primary Server)<a name="N55G"></a></h3><div class="body"><div class="textblock"><p>If jobs are updated on the primary server regularly and frequently, it will be easy for the query made by the reference job on the standby server to be canceled. In this case, edit one of the postgresql.conf file parameters shown in the table below.</p><table><caption>Table&nbsp;2.9 Parameters</caption><col><col><tr><th valign="top"><p>Parameter</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>hot_standby_feedback</p></td><td align="left" valign="top"><p>When "on" is set, the deletion (vacuum) of the data area that was deleted or updated on the primary server is suppressed.</p><p>Accordingly, the query on the standby server will not be canceled. <span class="inline-note">*1</span></p></td></tr><tr><td align="left" valign="top"><p>vacuum_defer_cleanup_age</p></td><td align="left" valign="top"><p>The deletion (vacuum) of the data area that was deleted or updated on the primary server is delayed until the specified number of transactions is processed. Accordingly, the probability that the query on the standby server will be canceled decreases.</p></td></tr></table><p class="supple">*1: Because the vacuum is delayed, the data storage destination disk space of the primary server comes under pressure.<br>Additionally, if there is conflict between accesses and queries executed on the standby server, transaction logs indicating this conflict will be transferred.<br>Accordingly, specify as large a value as possible for the max_standby_archive_delay parameter so that access conflicts do not occur.</p><div class="ref"><p class="title">See</p><div class="refbody"><ul><li><p>Refer to "Standby Servers" in the PostgreSQL Documentation for details on the hot_standby_feedback parameter.</p></li><li><p>Refer to "Master Server" in the PostgreSQL Documentation for details on the vacuum_defer_cleanup_age parameter.</p></li></ul></div></div><p></p></div></div><div class="header_footer"><div class="back_next"><a href="b1440-00-02-11-02.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-02-11-04.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>