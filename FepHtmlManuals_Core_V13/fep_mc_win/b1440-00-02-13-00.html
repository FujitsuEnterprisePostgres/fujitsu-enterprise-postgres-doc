<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>2.13 Setting Automatic Start and Stop of the Mirroring Controller Arbitration Process</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1440-00-02-00-00.html">Chapter&nbsp;2 Setting Up Database Multiplexing Mode</a> &gt; 2.13 Setting Automatic Start and Stop of the Mirroring Controller Arbitration Process</div><div class="back_next"><a href="b1440-00-02-12-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-02-14-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="mID_0614_arbiter_auto">2.13 Setting Automatic Start and Stop of the Mirroring Controller Arbitration Process<a name="N58G"></a></h2><div class="body"><div class="textblock"><p>You can automatically start or stop the Mirroring Controller arbitration process when the operating system on the arbitration server is started or stopped.</p><p></p></div><p class="subhead_1" id="IDclust06N22"><span class="red"><span class="em"></span></span><span class="em">Linux</span></p><div class="textblock"><div class="note"><p class="title">Note</p><div class="notebody"><p>If you start the Mirroring Controller arbitration process, wait for time correction, network setup, and so on.</p></div></div><p>Perform the following procedure:</p><ol><li><p>Create a unit file.</p><p>Copy the unit file sample stored in the directory below, and revise it to match the target instance.</p><pre>Sample file</pre><pre class="border">/<span class="i">installDir</span>/share/mcarboi.service.sample</pre><pre>Example)In the following example, the installation directory is "/opt/fsepv&lt;<span class="i">x</span>&gt;assistant", and the identifier of the arbitration process is "arbiter1". Note that "&lt;<span class="i">x</span>&gt;" indicates the product version.</pre><pre class="border"># cp /opt/fsepv&lt;<span class="i">x</span>&gt;assistant/share/mcarboi.service.sample /usr/lib/systemd/system/mcarboi_arbiter1.service</pre><p>Revise the underlined portions of the options below in the unit file.</p><table><col><col><col><col><tr><th valign="top"><p>Section</p></th><th valign="top"><p>Option</p></th><th valign="top"><p>Specified value</p></th><th valign="top"><p>Description</p></th></tr><tr><td align="left" valign="top"><p>Unit</p></td><td align="left" valign="top"><p>Description</p></td><td align="left" valign="top"><p>FUJITSU Enterprise Postgres Mirroring Controller Arbiter &lt;<span class="i">arbitrationProcessId</span>&gt;</p></td><td align="left" valign="top"><p>Specifies the feature overview.</p><p>Specifies the identifier of the targeted arbitration process. <span class="inline-note">*1</span></p></td></tr><tr><td rowspan="4" align="left" valign="top"><p>Service</p></td><td align="left" valign="top"><p>ExecStart</p></td><td align="left" valign="top"><p>/bin/bash -c '<span class="i"><span class="u">installDir</span></span>/bin/mc_arb_std start <span class="i"><span class="u">installDir</span></span><span class="u"> </span><span class="i"><span class="u">mirroringController</span></span><span class="i"><span class="u">ArbitrationProcessM</span></span><span class="i"><span class="u">gmt</span></span><span class="i"><span class="u">Dir</span></span><span class="u"> </span><span class="i"><span class="u">mc_arb</span></span><span class="i"><span class="u">Option</span></span>'</p></td><td align="left" valign="top"><p>Command to be executed when the service is started.</p><p>Specify the option you want to add when the mc_arb command is executed without the -M option in the mc_arb option.</p><p>Note that the content specified in this mc_arb option is carried over from the mc_arb_std command in "Specified value" to the mc_arb command.</p></td></tr><tr><td align="left" valign="top"><p>ExecStop</p></td><td align="left" valign="top"><p>/bin/bash -c '<span class="i"><span class="u">installDir</span></span>/bin/ mc_arb_std stop <span class="i"><span class="u">installDir</span></span><span class="u"> </span><span class="i"><span class="u">mirroringController</span></span><span class="i"><span class="u">ArbitrationProcessM</span></span><span class="i"><span class="u">gmt</span></span><span class="i"><span class="u">Dir</span></span><span class="u"> </span><span class="i"><span class="u">mc_arb</span></span><span class="i"><span class="u">Option</span></span>'</p></td><td align="left" valign="top"><p>Command to be executed when the service is stopped.</p><p>Specify the option you want to add when the mc_arb command is executed without the -M option in the mc_arb option.</p><p>Note that the content specified in this mc_arb option is carried over from the mc_arb_std command in "Specified value" to the mc_arb command.</p></td></tr><tr><td align="left" valign="top"><p>User</p></td><td align="left" valign="top"><p><span class="u">User</span></p></td><td align="left" valign="top"><p>Specify the account of the operating system user.</p></td></tr><tr><td align="left" valign="top"><p>Group</p></td><td align="left" valign="top"><p><span class="u">Group</span></p></td><td align="left" valign="top"><p>Specify the group to which the user belongs.</p></td></tr></table><p class="supple">*1: The arbitration process identifier used here is a name for identifying the Mirroring Controller arbitration process.</p><p class="supple">The naming conventions for identifying the Mirroring Controller arbitration process are as follows:</p><p class="supple">- Up to 16 bytes</p><p class="supple">- The first character must be an ASCII alphabetic character</p><p class="supple">- The other characters must be ASCII alphanumeric characters</p></li><li><p>Enable automatic start and stop.</p><p>As the operating system superuser, use the systemctl command to enable automatic start and stop.</p><pre>Example)</pre><pre class="border"># systemctl enable mcarboi_arbiter1.service</pre></li></ol></div><p class="subhead_1" id="IDclust06N24"><span class="red"><span class="em"></span></span><span class="em">Windows</span></p><div class="textblock"><p>You can configure the Windows service to perform automatic start and stop.</p><dl><dt class="em">Configuring during setup</dt><dd><p>When registering the Mirroring Controller arbitration process as a Windows service in "<a href="b1440-00-02-03-01.html">2.3.1 Configuring the Arbitration Server</a>", specify "auto" for the -S option of the register mode used with the mc_arb command.</p><pre>Example)</pre><pre class="border">&gt; mc_arb register -M D:\mcdir\inst1 -P ******** -S auto</pre></dd></dl><dl><dt class="em">Changing the configuration after setup</dt><dd><p>Use the sc config command to change the configuration of the Windows service of the Mirroring Controller arbitration process.</p><pre>Example)The configuration of the registered service name "Mirroring_Controller_Arbiter1" is changed.</pre><pre class="border">&gt; sc config "Mirroring_Controller_Arbiter1" start= auto</pre></dd></dl><div class="ref"><p class="title">See</p><div class="refbody"><p>Refer to sc command help for information on how to configure the service.</p></div></div><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>You can check the registration status in the Windows service window or by using the sc qc command.</p></div></div></div></div><div class="header_footer"><div class="back_next"><a href="b1440-00-02-12-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-02-14-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>