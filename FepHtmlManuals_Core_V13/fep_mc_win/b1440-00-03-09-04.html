<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>3.9.4 Changing to Database Multiplexing Mode when the Arbitration Server is Used for Automatic Degradation</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Cluster Operation Guide(Database Multiplexing)</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="b1440-00-03-00-00.html">Chapter&nbsp;3 Operations in Database Multiplexing Mode</a> &gt; <a href="b1440-00-03-09-00.html">3.9 Changes in Operation </a> &gt; 3.9.4 Changing to Database Multiplexing Mode when the Arbitration Server is Used for Automatic Degradation</div><div class="back_next"><a href="b1440-00-03-09-03.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-03-09-05.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="IDclust07N23">3.9.4 Changing to Database Multiplexing Mode when the Arbitration Server is Used for Automatic Degradation<a name="N84G"></a></h3><div class="body"><div class="textblock"><p>This section provides the procedure to change to database multiplexing mode using the Mirroring Controller only on the database server when the arbitration server is used for automatic degradation.</p><p>Some tasks must be performed on the database server, and others must be performed on the arbitration server.</p><p></p></div><p class="subhead_1" id="IDclust07N24"><span class="em">Tasks on the arbitration server</span></p><div class="textblock"><ol><li><p>Set up the arbitration server.</p><p>Refer to "<a href="b1440-00-02-03-00.html">2.3 Setting Up the Arbitration Server</a>" for information on how to set up the arbitration server.</p></li></ol></div><p class="subhead_1" id="IDclust07N25"><span class="em">Tasks on the database server</span></p><div class="textblock"><ol><li><p>On the server where Mirroring Controller is running, execute the mc_ctl command in stop mode to stop Mirroring Controller on the primary server and standby server.</p><pre>Example)</pre><pre class="border">&gt; mc_ctl stop -M D:\mcdir\inst1 -a --mc-only</pre></li><li><p>Edit the network.conf file of the primary server and standby server to add the information of the arbitration server.</p><p>Refer to "<a href="b1440-a-03-00.html">A.3 Network Configuration File</a>" for details.</p><p>The definition example of the network.conf file of the primary server is shown below:</p><pre>Example) </pre><pre>The IDs of the primary server and standby server are set to "server1" and "server2", and their port numbers are set to "27540" and "27541". The ID of the server of the Mirroring Controller arbitration process is set to "arbiter", and its port number is set to "27541".</pre><pre class="border">server1 192.0.2.100,192.0.3.100 27540,27541 serverserver2 192.0.2.110,192.0.3.110 27540,27541 serverarbiter 192.0.3.120 27541 arbiter</pre><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Ensure that the port numbers set for the primary server, standby server, and arbitration server do not conflict with other software. Also do not configure the same segment for the admin network and arbitration network.</p></li><li><p>If the server type is "server", two IP addresses or host names, and two port numbers need to be specified in the following order:</p><ul><li><p>IP address or host name of the database server used as the admin network</p></li><li><p>IP address or host name of the database server used as the arbitration network</p></li><li><p>Port number of the database server used as the admin network</p></li><li><p>Port number of the database server used as the arbitration network</p></li></ul></li><li><p>If the server type is "arbiter", specify the IP address or host name set for the my_address parameter and the port number set for the port parameter in arbitration.conf.</p></li></ul></div></div></li><li><p>Edit the <span class="i">serverIdentifier</span>.conf file of the primary server and standby server to add parameters required for the operation where the arbitration server is used for automatic degradation.</p><p>Refer to "<a href="b1440-a-04-01.html">A.4.1 Server Configuration File for the Database Servers</a>" for information on the parameters required when the arbitration server is used for automatic degradation.</p></li><li><p>On the primary server and standby server, execute the mc_ctl command in start mode to start the Mirroring Controller process.</p><pre>Example)</pre><pre class="border">&gt; mc_ctl start -M D:\mcdir\inst1 --mc-only</pre></li></ol><dl><dt class="em">Common tasks</dt><dd></dd></dl><ol><li><p>Check the connection status from the database server or arbitration server.</p><p>Refer to "<a href="b1440-00-02-08-00.html">2.8 Checking the Connection Status</a>" for details.</p></li></ol></div></div><div class="header_footer"><div class="back_next"><a href="b1440-00-03-09-03.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="b1440-00-03-09-05.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2016-2021 FUJITSU LIMITED</div></div></body></html>