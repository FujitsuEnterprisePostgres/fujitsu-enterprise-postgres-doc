<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>Appendix&nbsp;D Configuring Parameters</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Installation and Setup Guide for Server</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist">Appendix&nbsp;D Configuring Parameters</div><div class="back_next"><a href="j2674-c-00-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2674-e-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h1 id="mID_E" class="app">Appendix&nbsp;D Configuring Parameters</h1><div class="body"><div class="textblock"><p>WebAdmin operates and manages databases according to the contents of the following configuration files:</p><ul><li><p><a href="j2674-d-00-00.html#mID_postgresql_conf"><span class="u">postgr</span><span class="u">e</span><span class="u">sql</span><span class="u">.</span><span class="u">conf</span></a></p><p>Contains various items of information that define the operating environment of FUJITSU Enterprise Postgres.</p></li><li><p><a href="j2674-d-00-00.html#mID_pg_hba_conf"><span class="u">pg_h</span><span class="u">b</span><span class="u">a.conf</span></a></p><p>Contains various items of information related to client authentication.</p></li></ul><p>These configuration files are deployed to a data storage destination. Data is written to them when the instance is created by WebAdmin and when settings are changed, and data is read from them when the instance is started and when information from the [Setting] menu is displayed.</p><p>Direct editing of each configuration file is possible with a text editor.</p><div class="ref"><p class="title">See</p><div class="refbody"><p>Refer to "Server Configuration" and "Client Authentication" in "Server Administration" in the PostgreSQL Documentation for information on the parameters.</p></div></div><div class="note"><p class="title">Note</p><div class="notebody"><p>WebAdmin checks for port number and backup storage path anomalies when various operations are performed. An anomaly occurs when the value of [Port number] and/or [Backup storage path] in WebAdmin is different from the value of the corresponding parameter in postgresql.conf. Refer to "Anomaly Detection and Resolution" in the Operation Guide for details.</p></div></div><p></p></div><p class="subhead_1" id="mID_postgresql_conf"><span class="em">postgresql.conf</span><a name="N55G"></a></p><div class="textblock"><dl><dt class="em">Parameters that can be changed in WebAdmin</dt><dd><p>The postgresql.conf parameters that can be changed in WebAdmin are shown below:</p><table><col><col><col><tr><th valign="top"><p><span class="em">Section</span></p></th><th valign="top"><p><span class="em">WebAdmin item</span></p></th><th valign="top"><p><span class="em">p</span><span class="em">ostgresql.conf file p</span><span class="em">arameter</span></p></th></tr><tr><td colspan="3" align="left" valign="top"><p><span class="em">Instance Configuration</span></p></td></tr><tr><td rowspan="2" align="left" valign="top"><p>Character encoding</p></td><td align="left" valign="top"><p>Character set</p></td><td align="left" valign="top"><p>client_encoding</p></td></tr><tr><td align="left" valign="top"><p>Message locale</p></td><td align="left" valign="top"><p>lc_messages</p></td></tr><tr><td align="left" valign="top"><p>Communication</p></td><td align="left" valign="top"><p>Max connections</p></td><td align="left" valign="top"><p>max_connections</p></td></tr><tr><td rowspan="8" align="left" valign="top"><p>SQL options</p></td><td align="left" valign="top"><p>Transform NULL format</p></td><td align="left" valign="top"><p>transform_null_equals</p></td></tr><tr><td align="left" valign="top"><p>Date output format</p></td><td align="left" valign="top"><p>DateStyle <span class="inline-note">*1</span></p></td></tr><tr><td align="left" valign="top"><p>Interval output format</p></td><td align="left" valign="top"><p>IntervalStyle</p></td></tr><tr><td align="left" valign="top"><p>Number of digits for floating values</p></td><td align="left" valign="top"><p>extra_float_digits</p></td></tr><tr><td align="left" valign="top"><p>Transaction isolation levels</p></td><td align="left" valign="top"><p>default_transaction_isolation</p></td></tr><tr><td align="left" valign="top"><p>Currency format</p></td><td align="left" valign="top"><p>lc_monetary</p></td></tr><tr><td align="left" valign="top"><p>Date and time format</p></td><td align="left" valign="top"><p>lc_time</p></td></tr><tr><td align="left" valign="top"><p>Numerical value format</p></td><td align="left" valign="top"><p>lc_numeric</p></td></tr><tr><td rowspan="2" align="left" valign="top"><p>Memory</p></td><td align="left" valign="top"><p>Sort memory (KB)</p></td><td align="left" valign="top"><p>work_mem</p></td></tr><tr><td align="left" valign="top"><p>Shared buffers (KB)</p></td><td align="left" valign="top"><p>shared_buffers</p></td></tr><tr><td rowspan="6" align="left" valign="top"><p>Streaming replication</p></td><td align="left" valign="top"><p>WAL level</p></td><td align="left" valign="top"><p>wal_level</p></td></tr><tr><td align="left" valign="top"><p>Maximum WAL senders</p></td><td align="left" valign="top"><p>max_wal_senders</p></td></tr><tr><td align="left" valign="top"><p>WAL save size (MB)</p></td><td align="left" valign="top"><p>wal_keep_size</p></td></tr><tr><td align="left" valign="top"><p>Hot standby</p></td><td align="left" valign="top"><p>hot_standby</p></td></tr><tr><td align="left" valign="top"><p>Synchronous standby names</p></td><td align="left" valign="top"><p>synchronous_standby_names</p></td></tr><tr><td align="left" valign="top"><p>WAL receiver timeout (ms)</p></td><td align="left" valign="top"><p>wal_receiver_timeout</p></td></tr><tr><td colspan="3" align="left" valign="top"><p><span class="em">Edit instance</span></p></td></tr><tr><td rowspan="3" align="left" valign="top"></td><td align="left" valign="top"><p>Instance name</p></td><td align="left" valign="top"><p>n/a</p></td></tr><tr><td align="left" valign="top"><p>Instance port</p></td><td align="left" valign="top"><p>port</p></td></tr><tr><td align="left" valign="top"><p>Backup storage path</p></td><td align="left" valign="top"><p>backup_destination</p></td></tr></table><p>*1: If you specify "Postgres" as the output format, dates will be output in the "12-17-1997" format, not the "Wed Dec 17 1997" format used in the PostgreSQL Documentation.</p><div class="tips"><p class="title">Information</p><div class="tipsbody"><ul><li><p>Calculate the maximum number of connections using the formula below:</p><pre class="border"><span class="i">maximumNumberOfConnections</span> = <span class="i">maximumNumberOfConnectionsFromApplications</span> + 3 <span class="inline-note">*1</span></pre><p>*1: 3 is the default number of connections required by the system.<br>Calculate the maximum number of connections using the following formula when changing superuser_reserved_connections (connections reserved for use by the superuser) in postgresql.conf.</p><pre class="border"><span class="i">maximumNumberOfConnections</span> = <span class="i">maximumNumberOfConnectionsFromApplications</span> + superuser_reserved_connections </pre></li><li><p>Also check if the memory used exceeds the memory installed (refer to "<a href="j2674-d-00-00.html#mID_WebAdmin_memory">Parameters automatically set by WebAdmin according to the amount of memory</a>").</p></li></ul><ul><li><p>When modifying "Shared buffers" or "Max connections", edit the kernel parameter. Refer to "<a href="j2674-h-00-00.html">Appendix&nbsp;H Configuring Kernel Parameters</a>", and "Managing Kernel Resources" in "Server Administration" in the PostgreSQL Documentation for details.</p></li></ul></div></div></dd></dl><dl><dt class="em">Parameters set by WebAdmin</dt><dd><p>The following postgresql.conf parameters are set by WebAdmin during instance startup (they will be ignored even if specified in postgresql.conf):</p><table><col><col><tr><th valign="top"><p><span class="em">Parameter</span></p></th><th valign="top"><p><span class="em">Value</span></p></th></tr><tr><td align="left" valign="top"><p>listen_addresses</p></td><td align="left" valign="top"><p>*</p></td></tr><tr><td align="left" valign="top"><p>log_destination</p></td><td align="left" valign="top"><p>'stderr,syslog'</p></td></tr><tr><td align="left" valign="top"><p>logging_collector</p></td><td align="left" valign="top"><p>on</p></td></tr><tr><td align="left" valign="top"><p>log_line_prefix</p></td><td align="left" valign="top"><p>'%e: %t [%p]: [%l-1] user = %u,db = %d,remote = %r app = %a '</p></td></tr><tr><td align="left" valign="top"><p>log_filename <span class="inline-note">*1</span> <span class="inline-note">*2</span></p></td><td align="left" valign="top"><p>'logfile-%a.log'</p></td></tr><tr><td align="left" valign="top"><p>log_file_mode</p></td><td align="left" valign="top"><p>0600</p></td></tr><tr><td align="left" valign="top"><p>log_truncate_on_rotation</p></td><td align="left" valign="top"><p>on</p></td></tr><tr><td align="left" valign="top"><p>log_rotation_age</p></td><td align="left" valign="top"><p>1d</p></td></tr></table><p>*1: The server logs are split into files based on the day of the week, and are rotated after each week.</p><p>*2: If the date changes while the instance is stopped, old logs are not deleted and continue to exist.<br>Manually delete old logs that are no longer required to release disk space.</p><br><br></dd></dl><dl><dt class="em" id="mID_WebAdmin_memory">Parameters automatically set by WebAdmin according to the amount of memory</dt><dd><p>The postgresql.conf parameters automatically set according to the amount of installed memory, during the creation of instances by WebAdmin, are shown below:</p><table><col><col><tr><th valign="top"><p><span class="em">Parameter</span></p></th><th valign="top"><p><span class="em">Value</span></p></th></tr><tr><td align="left" valign="top"><p>shared_buffers</p></td><td align="left" valign="top"><p>30% of the machine's installed memory</p></td></tr><tr><td align="left" valign="top"><p>work_mem</p></td><td align="left" valign="top"><p>30% of the machine's installed memory / max_connections / 2</p></td></tr><tr><td align="left" valign="top"><p>effective_cache_size</p></td><td align="left" valign="top"><p>75% of the machine's installed memory</p></td></tr><tr><td align="left" valign="top"><p>maintenance_work_mem</p></td><td align="left" valign="top"><p>10% of the machine's installed memory / (1 + autovacuum_max_workers) <span class="inline-note">*1</span></p></td></tr></table><p>*1: The value will be capped at 2097151 KB.</p><p>When determining the values to be configured in the above parameters, you must take into account any anticipated increases in access volume or effects on performance during business operations, such as the number of applications and commands that will access the instance, and the content of processes. Also, note that in addition to FUJITSU Enterprise Postgres, other software may be running on the actual database server. You will need to determine the degree of priority for the database and other software, as well as the memory allocation size.</p><p>WebAdmin automatically configures complex parameter settings such as those mentioned above, based on the size of the internal memory of the machine. This enables maximum leverage of the machine memory to facilitate resistance against fluctuations during business operations.</p><p>Accordingly, the effects of the above-mentioned factors must be estimated and taken into account when determining and configuring parameter values, so that memory resources can be effectively allocated among other software or instances, and so that adverse effects can be mutually avoided. Refer to "Memory" in "Resource Consumption", and "Planner Cost Constants" in "Query Planning", under "Server Administration" in the PostgreSQL Documentation for information on parameter values and required considerations.</p><p>Parameter values can be modified using the WebAdmin [Setting] menu, or edited directly using a text editor.</p><p>If adding an instance, determine the parameter values, including for existing instances, and make changes accordingly.</p></dd></dl><div class="ref"><p class="title">See</p><div class="refbody"><p>Kernel parameters need to be tuned according to the parameters being changed. Refer to "<a href="j2674-h-00-00.html">Appendix&nbsp;H Configuring Kernel Parameters</a>", and "Managing Kernel Resources" in "Server Administration" in the PostgreSQL Documentation for information on tuning kernel parameters.</p></div></div><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Do not directly edit the following postgresql.conf parameters with a text editor, otherwise WebAdmin may not work properly if you make a mistake):</p><ul><li><p>archive_mode</p></li></ul><ul><li><p>archive_command</p></li></ul><ul><li><p>wal_level</p></li></ul><ul><li><p>log_line_prefix</p></li><li><p>log_destination</p></li><li><p>logging_collector</p></li><li><p>log_directory</p></li><li><p>log_file_mode</p></li><li><p>log_filename </p></li><li><p>log_truncate_on_rotation</p></li><li><p>log_rotation_age</p></li></ul></li><li><p>You must take care with the following parameter:</p><ul><li><p>superuser_reserved_connections</p><p>Set it to a number that includes the 3 connections required in WebAdmin (the default is 3).</p></li></ul></li></ul></div></div></div><p class="subhead_1" id="mID_pg_hba_conf"><span class="em">pg_hba.conf</span></p><div class="textblock"><p>Refer to "Client Authentication" in "Server Administration" in the PostgreSQL Documentation for information on content that can be configured in pg_hba.conf.</p><div class="note"><p class="title">Note</p><div class="notebody"><ul><li><p>Configure the instance administrator permissions in the "local" connection format settings. WebAdmin may not work properly if permissions are not configured.</p></li></ul><ul><li><p>If you specify an item or value that cannot be set by WebAdmin when editing the pg_hba.conf file with a text editor, it will not be possible to reference that line from WebAdmin.</p></li></ul></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2674-c-00-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2674-e-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>