<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>4.5.2 Configuring Automatic Start and Stop of an Instance</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Installation and Setup Guide for Server</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2674-00-04-00-00.html">Chapter&nbsp;4 Setup</a> &gt; <a href="j2674-00-04-05-00.html">4.5 Other Settings</a> &gt; 4.5.2 Configuring Automatic Start and Stop of an Instance</div><div class="back_next"><a href="j2674-00-04-05-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2674-00-04-05-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_040502_start_stop">4.5.2 Configuring Automatic Start and Stop of an Instance</h3><div class="body"><div class="textblock"><p>You can automatically start or stop an instance when the operating system on the database server is started or stopped.</p><p>Use the following procedure to configure automatic start and stop of an instance.</p><p>Note that, if an instance is started in a failover operation, the cluster system will control the start or stop, therefore this feature should not be used. Also, when performing database multiplexing, refer to "Enabling Automatic Start and Stop of Mirroring Controller and Multiplexed Instances" in the Cluster Operation Guide (Database Multiplexing).</p><p>Note that "&lt;<span class="i">x</span>&gt;" in paths indicates the product version.</p><ol><li><p>Create a unit file</p><p>Copy the unit file sample stored in the directory below, and revise it to match the target instance.</p><pre><span class="i">fujitsuEnterprisePostgresInstallDir</span>/share/fsepsvoi.service.sample</pre><dl><dt class="em">Example</dt><dd><p>In the following example, the installation directory is "/opt/fsepv&lt;<span class="i">x</span>&gt;server64", and the instance name is "inst1".</p><pre class="border"># cp /opt/fsepv&lt;<span class="i">x</span>&gt;server64/share/fsepsvoi.service.sample /usr/lib/systemd/system/fsepsvoi_inst1.service</pre></dd></dl><p>Revise the underlined portions of the options below in the unit file.</p><table><col><col><col><col><tr><th valign="top"><p><span class="em">Section</span></p></th><th valign="top"><p><span class="em">Option</span></p></th><th valign="top"><p><span class="em">Specified value</span></p></th><th valign="top"><p><span class="em">Description</span></p></th></tr><tr><td align="left" valign="top"><p>Unit</p></td><td align="left" valign="top"><p>Description</p></td><td align="left" valign="top"><p>FUJITSU Enterprise Postgres <span class="em"><span class="i"><span class="u">instanceName</span></span></span></p></td><td align="left" valign="top"><p>Specifies the feature overview.</p><p>Specifies the name of the target instance. <span class="inline-note">*1</span></p></td></tr><tr><td rowspan="5" height="40" align="left" valign="top"><p>Service</p></td><td height="40" align="left" valign="top"><p>ExecStart</p></td><td height="40" align="left" valign="top"><p>/bin/bash -c '<span class="em"><span class="i"><span class="u">installDir</span></span></span>/bin/pgx_symstd start <span class="em"><span class="i"><span class="u">installDir</span></span></span><span class="u"> </span><span class="em"><span class="i"><span class="u">dataStorageDestinationDir</span></span></span><span class="u">'</span></p></td><td height="40" align="left" valign="top"><p>Command to be executed when the service is started.</p></td></tr><tr><td height="17" align="left" valign="top"><p>ExecStop</p></td><td height="17" align="left" valign="top"><p>/bin/bash -c '<span class="em"><span class="i"><span class="u">installDir</span></span></span>/bin/pgx_symstd stop <span class="em"><span class="i"><span class="u">installDir</span></span></span><span class="u"> </span><span class="em"><span class="i"><span class="u">dataStorageDestinationDir</span></span></span><span class="u">'</span></p></td><td height="17" align="left" valign="top"><p>Command to be executed when the service is stopped.</p></td></tr><tr><td height="28" align="left" valign="top"><p>ExecReload</p></td><td height="28" align="left" valign="top"><p>/bin/bash -c '<span class="em"><span class="i"><span class="u">installDir</span></span></span>/bin/pgx_symstd reload <span class="em"><span class="i"><span class="u">installDir</span></span></span><span class="u"> </span><span class="em"><span class="i"><span class="u">dataStorageDestinationDir</span></span></span><span class="u">'</span></p></td><td height="28" align="left" valign="top"><p>Command to be executed when the service is reloaded</p></td></tr><tr><td height="17" align="left" valign="top"><p>User</p></td><td height="17" align="left" valign="top"><p><span class="em"><span class="u">User</span></span></p></td><td height="17" align="left" valign="top"><p>OS user account of the instance administrator.</p></td></tr><tr><td height="12" align="left" valign="top"><p>Group</p></td><td height="12" align="left" valign="top"><p><span class="em"><span class="u">Group</span></span></p></td><td height="12" align="left" valign="top"><p>Group to which the instance administrator user belongs.</p></td></tr></table><p>*1: The instance name should be as follows:</p><p>If WebAdmin is used to create the instance: <span class="i">instanceName</span></p><p>If the initdb command is used to create the instance: <span class="i">nameThatIdentifiesTheInstance</span><br>The naming conventions for the instance name or for identifying the instance are as follows:</p><ul><li><p>Up to 16 bytes</p></li><li><p>The first character must be an ASCII alphabetic character</p></li><li><p>The other characters must be ASCII alphanumeric characters</p></li></ul></li><li><p>Enable automatic start and stop</p><p>As the OS superuser, use the systemctl command to enable automatic start and stop.</p><dl><dt class="em">Example</dt><dd><pre class="border"># systemctl enable fsepsvoi_inst1.service</pre></dd></dl></li></ol><p></p></div></div><div class="header_footer"><div class="back_next"><a href="j2674-00-04-05-01.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2674-00-04-05-03.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>