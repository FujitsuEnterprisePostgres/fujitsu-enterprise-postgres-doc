<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>6.3 pgaudit Configuration File</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Security Operation Guide</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2680-00-06-00-00.html">Chapter&nbsp;6 Audit Log Feature</a> &gt; 6.3 pgaudit Configuration File</div><div class="back_next"><a href="j2680-00-06-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2680-00-06-06-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h2 id="mID_0604">6.3 pgaudit Configuration File</h2><div class="body"><div class="textblock"><p>In the pgaudit configuration file, specify the information required for pgaudit actions. The pgaudit configuration file comprises three sections: "output section", "option section", and "rule section".</p><p></p></div><p class="subhead_1" id="IDchap06N1"><span class="em">output section</span></p><div class="textblock"><p>The output section is specified using the format below:</p><ul><li><p><span class="i">paramName</span> = '<span class="i">value</span>'</p><br></li></ul><p>The valid parameters in the output section are shown in the table below.</p><div id="lix" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span>Linux</dt><dd><table id="lix_spcl_table" border="1" width="91%"><col><col><col><tr><th valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="em">Parameter name</span></p></div></th><th valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="em">Description</span></p></div></th><th valign="top"><div class="spcl_body"><p class="lix_spcl_cont"><span class="em">Remarks</span></p></div></th></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">logger</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Dedicated log file (auditlog)/<span class="i">serverLog</span> (serverlog) that will be the output destination of the audit log</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "auditlog" (dedicated log file).</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">The dedicated log file is output using the same encoding as used for the database.</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_directory</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Directory where the audit log is to be created</p></div><div class="spcl_body"><p class="lix_spcl_cont">Specify the full path or the relative path from the data storage directory.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "pgaudit_log".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_filename</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">File name of the audit log</p></div><div class="spcl_body"><p class="lix_spcl_cont">Specify a file name that varies according to the time, in the same manner as for log_filename in the postgresql.conf file.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "pgaudit-%Y-%m-%d_%H%M%S.log".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_file_mode</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Specify the permissions of the audit log so that only permitted persons can access it.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The parameter value is the numeric mode specified in the format permitted in chmod and umask system calls. The default is "0600".</p></div><div class="spcl_body"><p class="lix_spcl_cont">Refer to "<a href="j2680-00-06-02-00.html#mID_0602_log_file_mode"><span class="u">log_</span><span class="u">f</span><span class="u">ile</span><span class="u">_</span><span class="u">mode</span></a>" in "<a href="j2680-00-06-02-00.html">6.2 Setup</a>" for information on audit log file permissions.</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_rotation_age</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Maximum age of the audit log file</p></div><div class="spcl_body"><p class="lix_spcl_cont">A new audit log file is generated when the time (minute units) specified here elapses. To disable generation of new log files based on time, specify "0".</p></div><div class="spcl_body"><p class="lix_spcl_cont">The valid units are "min" (minutes), "h" (hours), and "d" (days). If the unit is omitted, "min" will be used.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "1d" (1 day).</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_rotation_size</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Maximum size of the audit log file</p></div><div class="spcl_body"><p class="lix_spcl_cont">A new log file will be generated after logs of the size specified here are output to a log file. To disable generation of new log files based on size, specify "0".</p></div><div class="spcl_body"><p class="lix_spcl_cont">The valid units are "kB" (kilobytes), "MB" (megabytes), and "GB" (gigabytes). If the unit is omitted, "kB" will be used.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "10MB".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">log_truncate_on_rotation</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">If rotating audit log files based on time, this parameter is used to specify whether to overwrite (on)/not overwrite (off) existing audit log files of the same name. For example, if "on" is specified, and "pgaudit-%H.log" is specified for log_filename, 24 separate log files will be generated based on time, and those files will be cyclically overwritten.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "off". If "off" is specified, the logs will be written to the existing audit log files.</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">fifo_directory</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">FIFO (named pipe) directory to be used between the daemon process that outputs audit log files and the backend process</p></div><div class="spcl_body"><p class="lix_spcl_cont">FIFO named p.PGAUDIT.<span class="i">nnnn</span> (<span class="i">nnnn</span> is the postmaster PID) are created in the fifo_directories directory. The files cannot be deleted manually.</p></div><div class="spcl_body"><p class="lix_spcl_cont">The default is "/tmp".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="lix_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr></table></dd></dl></div></div><div id="win" class="spcl"><div class="spcl_body"><dl><dt class="em"><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span>Windows</dt><dd><table id="win_spcl_table" border="1" width="91%"><col><col><col><tr><th valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="em">Parameter name</span></p></div></th><th valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="em">Description</span></p></div></th><th valign="top"><div class="spcl_body"><p class="win_spcl_cont"><span class="em">Remarks</span></p></div></th></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">logger</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Dedicated log file (auditlog)/<span class="i">serverLog</span> (serverlog) that will be the output destination of the audit log</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "auditlog" (dedicated log file).</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">The dedicated log file is output using the same encoding as used for the database.</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_directory</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Directory where the audit log is to be created</p></div><div class="spcl_body"><p class="win_spcl_cont">Specify the full path or the relative path from the data storage directory.</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "pgaudit_log".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_filename</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">File name of the audit log</p></div><div class="spcl_body"><p class="win_spcl_cont">Specify a file name that varies according to the time, in the same manner as for log_filename in the postgresql.conf file.</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "pgaudit-%Y-%m-%d_%H%M%S.log".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_file_mode</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">This parameter is ignored in Windows.</p></div></td><td align="left" valign="top"></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_rotation_age</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Maximum age of the audit log file</p></div><div class="spcl_body"><p class="win_spcl_cont">A new audit log file is generated when the time (minute units) specified here elapses. To disable generation of new log files based on time, specify "0".</p></div><div class="spcl_body"><p class="win_spcl_cont">The valid units are "min" (minutes), "h" (hours), and "d" (days). If the unit is omitted, "min" will be used.</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "1d" (1 day).</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_rotation_size</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Maximum size of the audit log file</p></div><div class="spcl_body"><p class="win_spcl_cont">A new log file will be generated after logs of the size specified here are output to a log file. To disable generation of new log files based on size, specify "0".</p></div><div class="spcl_body"><p class="win_spcl_cont">The valid units are "kB" (kilobytes), "MB" (megabytes), and "GB" (gigabytes). If the unit is omitted, "kB" will be used.</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "10MB".</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr><tr><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">log_truncate_on_rotation</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">If rotating audit log files based on time, this parameter is used to specify whether to overwrite (on)/not overwrite (off) existing audit log files of the same name. For example, if "on" is specified, and "pgaudit-%H.log" is specified for log_filename, 24 separate log files will be generated based on time, and those files will be cyclically overwritten.</p></div><div class="spcl_body"><p class="win_spcl_cont">The default is "off". If "off" is specified, the logs will be written to the existing audit log files.</p></div></td><td align="left" valign="top"><div class="spcl_body"><p class="win_spcl_cont">Enabled only if "auditlog" is specified for the logger parameter</p></div></td></tr></table></dd></dl></div></div><br><div class="tips"><p class="title">Information</p><div class="tipsbody"><p>If the logger parameter is set to "serverlog", audit logs will be output to the server log as log messages, therefore the status information and message severity level according to the log_line_prefix parameter in postgresql.conf will be output to the beginning of the audit log.</p><p>If the logger parameter is omitted or set to "auditlog", audit logs will be output to a dedicated log file as dedicated logs, therefore the status information and message severity level according to the log_line_prefix parameter in the postgresql.conf file will not be output.</p><p>Refer to "<a href="j2680-00-06-06-00.html#mID_06_session_output">Output format</a>" in "<a href="j2680-00-06-06-00.html">6.4 Session Audit Logging</a>"or "<a href="j2680-00-06-07-00.html#mID_06_object_output">Output format</a>" in "<a href="j2680-00-06-07-00.html">6.5 Object Audit Logging</a>" for information on the output format of audit logs.</p></div></div><div id="lix" class="spcl_note_title"><div class="spcl_body"><div class="point"><span class="icon"><img src="image/spcl-lix.gif" width="25" height="18" alt="Linux" title="Linux"></span><p class="title">Point</p><div class="pointbody"><div id="lix" class="spcl_note"><div class="spcl_body"><p>The pgaudit log_file_mode configuration parameter setting is separate from, and unaffected by, the log_file_mode GUC parameter setting and the -g/-allow-group-access initdb option.</p></div></div><div id="lix" class="spcl_note"><div class="spcl_body"><p>When using a dedicated pgaudit log file, since the pgaudit log_directory location defaults to inside the data storage directory, it is possible for the pgaudit log_file_mode permissions to conflict with the intended file permissions specified by the -g/-allow-group-access initdb option. In this case, the pgaudit log_directory should be specified to be a directory located outside of the data storage directory.</p></div></div></div></div></div></div><div id="win" class="spcl_note_title"><div class="spcl_body"><div class="point"><span class="icon"><img src="image/spcl-win.gif" width="25" height="18" alt="Windows" title="Windows"></span><p class="title">Point</p><div class="pointbody"><div id="win" class="spcl_note"><div class="spcl_body"><p>If the file permissions for the server log do not satisfy the security requirements of the system, specify a dedicated log file for the output destination of the audit log, and set the access permissions for the output destination directory so that the security requirements are satisfied. At that time, assign read and write permissions to the database administrator.</p></div></div></div></div></div></div><br></div><p class="subhead_1" id="IDchap06N2"><span class="em">option section</span></p><div class="textblock"><p>The option section is specified using the format below:</p><ul><li><p><span class="i">paramName</span> = '<span class="i">value</span>'</p><br></li></ul><p>The valid parameters in the option section are shown in the table below.</p><table><col><col><col><tr><th valign="top"><p><span class="em">Parameter name</span></p></th><th valign="top"><p><span class="em">Description</span></p></th><th valign="top"><p><span class="em">Remarks</span></p></th></tr><tr><td align="left" valign="top"><p>role</p></td><td align="left" valign="top"><p>Name of roles used in Object Audit Logging</p><p>If specifying a name containing uppercase characters, key words, multibyte characters and commas, enclose the name in double quotation marks.</p></td><td align="left" valign="top"><p>Parameter used in Object Audit Logging only</p></td></tr><tr><td align="left" valign="top"><p>log_catalog</p></td><td align="left" valign="top"><p>Whether to enable (on)/disable (off) log output for pg_catalog</p><p>If pgAdmin, and so on, will not be retrieving audit logs that access pg_catalog, specify "off".</p><p>The default is "on" (enabled).</p></td><td align="left" valign="top"></td></tr><tr><td align="left" valign="top"><p>log_parameter</p></td><td align="left" valign="top"><p>Whether to enable (on)/disable (off) output of values passed by parameters in SQL execution</p><p>The default is "off" (disabled).</p></td><td align="left" valign="top"></td></tr><tr><td align="left" valign="top"><p>log_statement_once</p></td><td align="left" valign="top"><p>Whether to control (on)/not control (off) output for the second and subsequent SQL statements if the same SQL statement is the log output target</p><p>The default is "off" (do not control).</p></td><td align="left" valign="top"></td></tr><tr><td align="left" valign="top"><p>log_level</p></td><td align="left" valign="top"><p>Log level of audit logs</p><p>The valid values are "DEBUG5", "DEBUG4", "DEBUG3", "DEBUG2", "DEBUG1", "INFO", "NOTICE", "WARNING", and "LOG".</p><p>The default is "LOG".</p></td><td align="left" valign="top"><p>Enabled only if "serverlog" is specified for the logger parameter</p></td></tr></table></div><p class="subhead_1" id="IDchap06N3"><span class="em">rule section</span></p><div class="textblock"><p>The rule section is used in Session Audit Logging. Refer to "<a href="j2680-00-06-06-00.html">6.4 Session Audit Logging</a>" for details.</p><div class="note"><p class="title">Note</p><div class="notebody"><p>Do not specify the rule section if the role parameter has been specified in the option section. If you specify the rule section, the audit logs of Object Audit Logging and Session Audit Logging will be output intermingled and you will be unable to view the logs in CSV format.</p></div></div></div></div><div class="header_footer"><div class="back_next"><a href="j2680-00-06-02-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2680-00-06-06-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2018-2021 FUJITSU LIMITED </div></div></body></html>