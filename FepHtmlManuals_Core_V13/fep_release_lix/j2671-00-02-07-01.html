<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><META CONTENT="4.3" NAME="GeneratorVersion"><title>2.7.1 Changing to Print Extra NEW and OLD Values in the Audit Log when the Trigger Function Executes</title><link rel="stylesheet" href="manualmain.css" type="TEXT/CSS"><script language="JavaScript" src="topbutton.js"></script></head><body onload="init()"><div class="topButton" id="topButton0"><a class="topButton" href="#top"><img src="image/top.gif" width="62" height="20" border="0" alt="Top" title="Top"></a></div><div class="top_header"><div class="top_header_title"><a title="Title Page" class="top_link" target="_top" HREF="index.html">Enterprise Postgres 13&nbsp;Release Notes</a></div><div class="top_header_graphic"><span class="top_logo"><img src="image/logo-white-fj.gif" width="148" height="32" alt=""></span><span class="top_keygraphic"><img src="image/cover-header-graphic.gif" width="148" height="32" alt="FUJITSU Software"></span></div></div><div class="header_footer"><div class="breadcrumbslist"><a href="j2671-00-02-00-00.html">Chapter&nbsp;2 Compatibility Information</a> &gt; <a href="j2671-00-02-07-00.html">2.7 pgaudit Incompatibility</a> &gt; 2.7.1 Changing to Print Extra NEW and OLD Values in the Audit Log when the Trigger Function Executes</div><div class="back_next"><a href="j2671-00-02-07-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2671-00-03-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div></div><h3 id="mID_02_pgaudit02_fep13">2.7.1 Changing to Print Extra NEW and OLD Values in the Audit Log when the Trigger Function Executes</h3><div class="body"><div class="textblock"><p></p></div><p class="subhead_1" id="IDchap2-14-pgauditN2"><span class="em">Incompatibility</span></p><div class="textblock"><p>In FUJITSU Enterprise Postgres 13, the trigger function additionally outputs NEW and OLD values to the audit log when the pgaudit.log_parameter is set to on.</p><dl><dt class="em">FUJITSU Enterprise Postgres 12 or earlier</dt><dd><p>The following (18) does not output the values of New, OLD.</p><p>[Example]</p><pre>AUDIT: SESSION,WRITE,2020-09-03 07:07:39 UTC,        (1)    (2)   (3)[local],9775,psql,k5user,postgres,3/536, 1, 2, INSERT, ,(4)     (5)  (6)  (7)    (8)      (9)   (10)(11)(12)(13)TABLE,public.trig_audit, ,(14)  (15)    (16) "INSERT INTO trig_audit SELECT 'U', now(), user, OLD.*, NEW.*",(17)trig_audit AFTER ROW UPDATE 92027 trig_test trig_test public 0  f aaaa(18)</pre></dd></dl><dl><dd></dd></dl><dl><dt class="em">FUJITSU Enterprise Postgres 13 or later</dt><dd><p>New, OLD values are printed.</p><p>[Example]</p><pre>AUDIT: SESSION,WRITE,2020-09-03 07:07:39 UTC, [local],9775,psql,k5user,postgres,3/536,1,2,INSERT,,TABLE,public.trig_audit,,"INSERT INTO trig_audit SELECT 'U', now(), user, OLD.*, NEW.*",(bbb) (aaa) trig_audit AFTER ROW UPDATE 92027 trig_test trig_testpublic 0  f aaaa</pre></dd></dl></div><p class="subhead_1" id="IDchap2-14-pgauditN3"><span class="em">Action method</span></p><div class="textblock"><p>If you are using an application that works by monitoring the string that the trigger function prints to the audit log, modify the application to work with the NEW and OLD values.</p></div></div><div class="header_footer"><div class="back_next"><a href="j2671-00-02-07-00.html"><img src="image/back2.gif" width="65" height="27" border="0" alt="Previous" title="Previous"></a><a href="j2671-00-03-00-00.html"><img src="image/next2.gif" width="64" height="27" border="0" alt="Next" title="Next"></a></div><div class="copyright">Copyright 2015-2021 FUJITSU LIMITED</div></div></body></html>